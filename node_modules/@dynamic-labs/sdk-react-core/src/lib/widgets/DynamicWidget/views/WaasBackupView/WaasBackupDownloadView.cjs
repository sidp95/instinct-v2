'use client'
'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var jsxRuntime = require('react/jsx-runtime');
var React = require('react');
var reactI18next = require('react-i18next');
var ErrorContainer = require('../../../../components/ErrorContainer/ErrorContainer.cjs');
var IconButton = require('../../../../components/IconButton/IconButton.cjs');
var ModalHeader = require('../../../../components/ModalHeader/ModalHeader.cjs');
var Typography = require('../../../../components/Typography/Typography.cjs');
var TypographyButton = require('../../../../components/TypographyButton/TypographyButton.cjs');
var ViewContext = require('../../../../context/ViewContext/ViewContext.cjs');
var check = require('../../../../shared/assets/check.cjs');
var download = require('../../../../shared/assets/download.cjs');
var questionMark = require('../../../../shared/assets/question-mark.cjs');
require('@dynamic-labs/iconic');
var useWalletBackup = require('../../../../utils/hooks/useWalletBackup/useWalletBackup.cjs');
require('../../../../utils/hooks/useWalletBackup/types.cjs');
var BackupStepper = require('./BackupStepper.cjs');

const WaasBackupDownloadView = () => {
    const { pushView } = ViewContext.useViewContext();
    const { t } = reactI18next.useTranslation();
    const handleComplete = React.useCallback((walletCount) => {
        pushView('waas-backup-success-view', { walletCount });
    }, [pushView]);
    const { currentIndex, hasError, isComplete, isProcessing, retry, startDownload, totalWallets, } = useWalletBackup.useDownloadKeyShares(handleComplete);
    const handleInfoClick = React.useCallback(() => {
        pushView('waas-backup-info-view');
    }, [pushView]);
    const infoButton = (jsxRuntime.jsx(IconButton.IconButton, { type: 'button', onClick: handleInfoClick, "data-testid": 'info-button', children: jsxRuntime.jsx(questionMark.ReactComponent, {}) }));
    const getButtonContent = () => {
        if (isComplete) {
            return (jsxRuntime.jsxs("span", { className: 'waas-backup-view__download-button-content', children: [jsxRuntime.jsx(check.ReactComponent, { className: 'waas-backup-view__download-icon' }), t('dyn_waas.backup.download_complete')] }));
        }
        if (isProcessing) {
            return (jsxRuntime.jsxs("span", { className: 'waas-backup-view__download-button-content', children: [jsxRuntime.jsx(download.ReactComponent, { className: 'waas-backup-view__download-icon' }), t('dyn_waas.backup.downloading', {
                        current: currentIndex,
                        total: totalWallets,
                    })] }));
        }
        if (hasError) {
            return t('dyn_waas.backup.error_try_again');
        }
        return t('dyn_waas.backup.download_key_share');
    };
    return (jsxRuntime.jsxs(jsxRuntime.Fragment, { children: [jsxRuntime.jsx(ModalHeader.ModalHeader, { trailing: infoButton, children: jsxRuntime.jsx(Typography.Typography, { variant: 'title', color: 'primary', copykey: 'dyn_waas.backup.title', children: t('dyn_waas.backup.title') }) }), jsxRuntime.jsx("div", { className: 'waas-backup-view', children: jsxRuntime.jsxs("div", { className: 'waas-backup-view__body', children: [jsxRuntime.jsx(BackupStepper.BackupStepper, { currentStep: 1, completedSteps: 1 }), hasError && (jsxRuntime.jsx(ErrorContainer.ErrorContainer, { variant: 'error', withIcon: false, children: t('dyn_waas.backup.download_error') })), jsxRuntime.jsx(Typography.Typography, { variant: 'title', color: 'primary', copykey: 'dyn_waas.backup.download_title', className: 'waas-backup-view__cloud-title', children: t('dyn_waas.backup.download_title') }), jsxRuntime.jsx(Typography.Typography, { variant: 'body_normal', color: 'secondary', copykey: 'dyn_waas.backup.download_subtitle', className: 'waas-backup-view__cloud-subtitle', children: t('dyn_waas.backup.download_subtitle') }), jsxRuntime.jsx(TypographyButton.TypographyButton, { dataTestId: 'download-key-share-button', onClick: hasError ? retry : startDownload, disabled: isProcessing || isComplete, buttonVariant: isProcessing || isComplete ? 'secondary' : 'brand-primary', typographyProps: {
                                color: 'inherit',
                            }, expanded: true, children: getButtonContent() })] }) })] }));
};

exports.WaasBackupDownloadView = WaasBackupDownloadView;
