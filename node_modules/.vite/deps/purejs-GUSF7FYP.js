import {
  createHash
} from "./chunk-GX5ZUNPE.js";
import {
  uint8ArrayToHexString
} from "./chunk-TJGQWPPV.js";
import {
  Field,
  createCurve,
  createHasher,
  mapToCurveSimpleSWU,
  sha256
} from "./chunk-CYXDKUZK.js";
import "./chunk-MVEJMUOB.js";

// node_modules/@noble/curves/esm/p256.js
var Fp256 = Field(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"));
var CURVE_A = Fp256.create(BigInt("-3"));
var CURVE_B = BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b");
var p256 = createCurve({
  a: CURVE_A,
  // Equation params: a, b
  b: CURVE_B,
  Fp: Fp256,
  // Field: 2n**224n * (2n**32n-1n) + 2n**192n + 2n**96n-1n
  // Curve order, total count of valid points in the field
  n: BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),
  // Base (generator) point (x, y)
  Gx: BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),
  Gy: BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),
  h: BigInt(1),
  lowS: false
}, sha256);
var secp256r1 = p256;
var mapSWU = (() => mapToCurveSimpleSWU(Fp256, {
  A: CURVE_A,
  B: CURVE_B,
  Z: Fp256.create(BigInt("-10"))
}))();
var htf = (() => createHasher(secp256r1.ProjectivePoint, (scalars) => mapSWU(scalars[0]), {
  DST: "P256_XMD:SHA-256_SSWU_RO_",
  encodeDST: "P256_XMD:SHA-256_SSWU_NU_",
  p: Fp256.ORDER,
  m: 1,
  k: 128,
  expand: "xmd",
  hash: sha256
}))();
var hashToCurve = (() => htf.hashToCurve)();
var encodeToCurve = (() => htf.encodeToCurve)();

// node_modules/@turnkey/api-key-stamper/dist/purejs.mjs
var signWithApiKey = async (input) => {
  const publicKey = p256.getPublicKey(input.privateKey, true);
  const publicKeyString = uint8ArrayToHexString(publicKey);
  if (publicKeyString != input.publicKey) {
    throw new Error(`Bad API key. Expected to get public key ${input.publicKey}, got ${publicKeyString}`);
  }
  const hash = createHash().update(input.content).digest();
  const signature = p256.sign(hash, input.privateKey);
  return signature.toDERHex();
};
export {
  signWithApiKey
};
/*! Bundled license information:

@noble/curves/esm/p256.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=purejs-GUSF7FYP.js.map
