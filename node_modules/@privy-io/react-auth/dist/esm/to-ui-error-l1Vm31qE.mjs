import{jsxs as e,jsx as o,Fragment as r}from"react/jsx-runtime";import n from"@heroicons/react/24/outline/DevicePhoneMobileIcon";import i from"@heroicons/react/24/outline/FingerPrintIcon";import t from"@heroicons/react/24/outline/PhoneIcon";import a from"@heroicons/react/24/outline/ShieldCheckIcon";import{b as s,M as c,P as l,S as d}from"./ModalHeader-D5psNgrf.mjs";import{S as m}from"./ScreenLayout-DIdy7nhJ.mjs";import{U as h,V as p,a4 as u}from"./useActiveWallet-RUYo4pXO.mjs";import{M as g,F as f,T as y,L as C,b as k,c as T,C as S,E as b,P as v,I,N as w,S as P}from"./PinInput-3SLvbnQa.mjs";import j from"@heroicons/react/24/outline/CalendarIcon";import x from"@heroicons/react/24/outline/ExclamationTriangleIcon";import{e as B}from"./StackedContainer-B2vaEl56.mjs";import{u as E}from"./internal-context-e-Eni5bG.mjs";import{useState as M,useMemo as V,useEffect as A}from"react";import{styled as L}from"styled-components";import{toHex as D}from"viem";import{u as F}from"./useGetTokenPrice-C1-pGMgN.mjs";import{u as Y}from"./useWallets-BkIu5vyx.mjs";import{p as H,j as N,g as W,h as G}from"./index-ygZBlWlm.mjs";import{g as J}from"./getPublicClient-A9RSftUZ.mjs";import{T as K}from"./TransactionDetails-DB8AH1mq.mjs";import{u as O}from"./context-Bu4xmqpC.mjs";const U=({handleClose:r,user:c,onSelect:l})=>/*#__PURE__*/e(m,{title:"Verify your identity",subtitle:"Choose a verification method",icon:a,iconVariant:"subtle",onClose:r,showClose:!0,watermark:!0,children:[/*#__PURE__*/e(g,{children:[c.mfaMethods.includes("totp")&&/*#__PURE__*/e(h,{onClick:()=>l("totp"),children:[/*#__PURE__*/o(p,{children:/*#__PURE__*/o(n,{})}),"Authenticator app"]},"totp"),c.mfaMethods.includes("sms")&&/*#__PURE__*/e(h,{onClick:()=>l("sms"),children:[/*#__PURE__*/o(p,{children:/*#__PURE__*/o(t,{})}),"SMS"]},"sms"),c.mfaMethods.includes("passkey")&&/*#__PURE__*/e(h,{onClick:()=>l("passkey"),children:[/*#__PURE__*/o(p,{children:/*#__PURE__*/o(i,{})}),"Passkey"]},"passkey")]}),/*#__PURE__*/o(s,{})]}),q=({pendingTransaction:e})=>{let{wallets:r}=Y(),{walletProxy:n,rpcConfig:i,chains:t,appId:a,nativeTokenSymbolForChainId:s}=E(),[c,l]=M(null),[d,m]=M(e),{tokenPrice:h}=F(d.chainId),p=s(e.chainId)||"ETH",u=V((()=>r.find((e=>"privy"===e.walletClientType))),[r]);return A((()=>{(async function(){if(!n||!u)return d;let e=J(d.chainId,t,i,{appId:a}),o=await H(d,e,u.address);return l(D(BigInt(o.gas??0))),o})().then(m).catch(console.error)}),[n]),u?/*#__PURE__*/o(z,{children:/*#__PURE__*/o(K,{from:u.address,to:d.to,txn:d,gas:c??void 0,tokenPrice:h,tokenSymbol:p})}):null};let z=L.div`
  width: 100%;
  padding: 1rem 0;
`;const Q=({hasBlockingError:n,error:i,onClose:t,onBack:d,handleSubmit:m,account:h,submitSuccess:p})=>{let{pendingTransaction:g}=E();/*#__PURE__*/return e(r,{children:[/*#__PURE__*/o(c,{onClose:t},"header"),/*#__PURE__*/o(B,{children:/*#__PURE__*/e("div",{children:[/*#__PURE__*/o(u,{success:p,fail:!!i}),/*#__PURE__*/o(i?x:f,{style:{width:"38px",height:"38px"}})]})}),/*#__PURE__*/o(y,{style:{marginTop:"1rem"},children:"Verifying with passkey"}),/*#__PURE__*/e(C,{children:[/*#__PURE__*/e(k,{children:[/*#__PURE__*/o(T,{children:/*#__PURE__*/o(a,{})}),"Approve this action using your touch, face, PIN, or hardware key."]}),/*#__PURE__*/e(k,{children:[/*#__PURE__*/o(T,{children:/*#__PURE__*/o(j,{})}),"You last added a passkey on"," ",h?.firstVerifiedAt?.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}),"."]})]}),g&&/*#__PURE__*/o(S,{children:/*#__PURE__*/o(q,{pendingTransaction:g})}),i&&/*#__PURE__*/e(r,{children:[/*#__PURE__*/o(b,{style:{marginTop:"1.25rem"},children:i.message}),/*#__PURE__*/o(l,{disabled:n,onClick:m,style:{margin:"1.25rem auto 0"},children:"Try again"})]}),d&&/*#__PURE__*/o(v,{style:{marginTop:"1rem"},onClick:d,children:"Choose another method"}),/*#__PURE__*/o(s,{})]})},R=({selectedMethod:i,submitSuccess:a,hasBlockingError:l,onClose:m,onBack:h,handleSubmitCode:p})=>{let u=O(),{pendingTransaction:g}=E();switch(i){case"sms":/*#__PURE__*/return e(r,{children:[/*#__PURE__*/o(c,{onClose:m},"header"),/*#__PURE__*/o(I,{style:{marginBottom:"1.5rem"},children:/*#__PURE__*/o(t,{})}),/*#__PURE__*/o(y,{children:"Enter verification code"}),/*#__PURE__*/e(S,{children:[/*#__PURE__*/o(w,{success:a,disabled:l,onChange:p}),/*#__PURE__*/e(P,{children:["To continue, please enter the 6-digit code sent to your ",/*#__PURE__*/o("strong",{children:"mobile device"})]}),g&&/*#__PURE__*/o(q,{pendingTransaction:g})]}),h&&/*#__PURE__*/o(v,{theme:u?.appearance.palette.colorScheme,onClick:h,children:"Choose another method"}),/*#__PURE__*/o(d,{onClick:m,children:"Cancel"}),/*#__PURE__*/o(s,{})]});case"totp":/*#__PURE__*/return e(r,{children:[/*#__PURE__*/o(c,{onClose:m},"header"),/*#__PURE__*/o(I,{style:{marginBottom:"1.5rem"},children:/*#__PURE__*/o(n,{})}),/*#__PURE__*/o(y,{children:"Enter verification code"}),/*#__PURE__*/e(S,{children:[/*#__PURE__*/o(w,{success:a,disabled:l,onChange:p}),/*#__PURE__*/e(P,{children:["To continue, please enter the 6-digit code generated from your"," ",/*#__PURE__*/o("strong",{children:"authenticator app"})]}),g&&/*#__PURE__*/o(q,{pendingTransaction:g})]}),h&&/*#__PURE__*/o(v,{theme:u?.appearance.palette.colorScheme,onClick:h,children:"Choose another method"}),/*#__PURE__*/o(d,{onClick:m,children:"Cancel"}),/*#__PURE__*/o(s,{})]});default:return null}},X=e=>N(e)?{isBlocking:!0,error:Error("You have exceeded the maximum number of attempts. Please close this window and try again in 10 seconds.")}:W(e)?{isBlocking:!1,error:Error("The code you entered is not valid")}:G(e)?{isBlocking:!0,error:Error("You have exceeded the time limit for code entry. Please try again in 30 seconds.")}:(console.error(e),{isBlocking:!1,error:Error("Something went wrong.")});export{Q as V,R as a,U as b,X as t};
