import{d5 as y,d7 as x,d9 as c,d4 as r,ds as p,dt as b,du as j,dv as w}from"./index-BZUZJG0z.js";import{F}from"./ArrowsRightLeftIcon-PAKpD01z.js";import{F as C}from"./CheckCircleIcon-CpqaWuvB.js";import{T as S,b as k,m as D}from"./ModalHeader-D5psNgrf-BlEKM6aB.js";import{a as I}from"./Layouts-BlFm53ED-D8gWrHLU.js";import{t as M}from"./analytics-mkkvFRju-DOXuftJB.js";const G={component:()=>{let{data:e,setModalData:t,navigate:n,navigateBack:a}=y(),{closePrivyModal:i,createAnalyticsEvent:u,client:h}=x(),[d,m]=c.useState("pending-in-flow"),g=c.useRef(0),o={...e==null?void 0:e.funding,showAlternateFundingMethod:!0};o.usingDefaultFundingMethod&&(o.usingDefaultFundingMethod=!1);let{partnerUserId:f,popup:l}=(e==null?void 0:e.coinbaseOnrampStatus)??{};return c.useEffect((()=>{if(d==="pending-in-flow"||d==="pending-after-flow"){let v=setInterval((async()=>{if(f)try{let{status:s}=await h.getCoinbaseOnRampStatus({partnerUserId:f});if(s==="success")return void m("success");if(s==="failure")throw Error("There was an error completing Coinbase Onramp flow.");if(g.current>=3)return t({funding:o,solanaFundingData:e==null?void 0:e.solanaFundingData}),void n("FundingMethodSelectionScreen");l!=null&&l.closed&&(g.current=g.current+1,m("pending-after-flow"))}catch(s){console.error(s),m("error"),u({eventName:M,payload:{status:"failure",provider:"coinbase-onramp",error:s.message}}),t({funding:{...o,errorMessage:"Something went wrong adding funds. Please try again or use another method."},solanaFundingData:e==null?void 0:e.solanaFundingData}),n("FundingMethodSelectionScreen")}}),1500);return()=>clearInterval(v)}}),[f,l,d]),r.jsxs(r.Fragment,{children:[r.jsx(S,{title:"Fund account",backFn:()=>{t({funding:o,solanaFundingData:e==null?void 0:e.solanaFundingData}),a()}},"header"),r.jsx(R,{status:d,onClickCta:i}),r.jsx(k,{})]})}};let R=({status:e,onClickCta:t})=>{let{title:n,body:a,cta:i}=c.useMemo((()=>(u=>{switch(u){case"success":return{title:"You've funded your account!",body:"It may take a few minutes for the assets to appear.",cta:"Continue"};case"pending-after-flow":return{title:"In Progress",body:"Almost done. Retrieving transaction status from Coinbase",cta:""};case"error":case"pending-in-flow":return{title:"In Progress",body:"Go back to Coinbase Onramp to finish funding your account.",cta:""}}})(e)),[e]);return r.jsxs(r.Fragment,{children:[r.jsxs(O,{children:[r.jsx(P,{isSucccess:e==="success"}),r.jsxs(I,{children:[r.jsx("h3",{children:n}),r.jsx(E,{children:a})]})]}),i&&r.jsx(D,{onClick:t,children:i})]})},P=({isSucccess:e})=>{if(!e){let a="var(--privy-color-foreground-4)";return r.jsxs("div",{style:{position:"relative"},children:[r.jsx(b,{color:a,style:{position:"absolute"}}),r.jsx(j,{color:a}),r.jsx(w,{style:{position:"absolute",width:"2.8rem",height:"2.8rem",top:"1.2rem",left:"1.2rem"}})]})}let t=e?C:()=>r.jsx(F,{width:"3rem",height:"3rem",style:{backgroundColor:"var(--privy-color-foreground-4)",color:"var(--privy-color-background)",borderRadius:"100%",padding:"0.5rem",margin:"0.5rem"}}),n=e?"var(--privy-color-success)":"var(--privy-color-foreground-4)";return r.jsx("div",{style:{borderColor:n,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"100%",borderWidth:2,padding:"0.5rem",marginBottom:"0.5rem"},children:t&&r.jsx(t,{width:"4rem",height:"4rem",color:n})})},E=p.p`
  font-size: 1rem;
  color: var(--privy-color-foreground-3);
  margin-bottom: 1rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
`,O=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  margin-left: 1.75rem;
  margin-right: 1.75rem;
  padding: 2rem 0;
`;export{G as CoinbaseOnrampStatusScreen,G as default};
