import{d9 as t,dA as M,d7 as T,d5 as A,dq as L,e3 as D,d6 as U,da as $,db as I,e4 as R,d4 as a,ds as N,e5 as q}from"./index-BZUZJG0z.js";import{V,m as W}from"./ModalHeader-D5psNgrf-BlEKM6aB.js";import{n as _}from"./Chip-D2-wZOHJ-DUiT6Tro.js";import{t as K,a as z}from"./EmailInputForm-Dgoii4vf-Cv4GPqoL.js";import{e as B}from"./ErrorMessage-D8VaAP5m-C-TFvMaa.js";import{M as H}from"./mail-BQhl7vwX.js";const ae=t.forwardRef(((n,x)=>{let[i,y]=t.useState(n.defaultValue||""),[s,p]=t.useState(""),[o,g]=t.useState(!1),{authenticated:E}=M(),{initLoginWithEmail:h}=T(),{navigate:d,setModalData:c,currentScreen:j,data:e}=A(),{enabled:v,token:f}=L(),[b,k]=t.useState(!1),{accountType:w}=D(),P=U();t.useEffect((()=>{var r,l;!i&&P.disablePlusEmails&&((r=e==null?void 0:e.inlineError)==null?void 0:r.error)instanceof $&&((l=e==null?void 0:e.inlineError)==null?void 0:l.error.privyErrorCode)===I.DISALLOWED_PLUS_EMAIL&&!s&&p("Please enter a valid email address without a '+'."),s&&p("")}),[i]);let C=R(i),S=o||!C,u=()=>{var l;var r;c({login:e==null?void 0:e.login,inlineError:void 0}),!v||f||E?(r=f,g(!0),h({email:i,captchaToken:r,disableSignup:(l=e==null?void 0:e.login)==null?void 0:l.disableSignup,withPrivyUi:!0}).then((()=>{d("AwaitingPasswordlessCodeScreen")})).catch((m=>{c({errorModalData:{error:m,previousScreen:j||"LandingScreen"}}),d("ErrorScreen")})).finally((()=>{g(!1)}))):(c({captchaModalData:{callback:m=>h({email:i,captchaToken:m,withPrivyUi:!0}),userIntentRequired:!1,onSuccessNavigateTo:"AwaitingPasswordlessCodeScreen",onErrorNavigateTo:"ErrorScreen"}}),d("CaptchaScreen"))};return a.jsxs(a.Fragment,{children:[a.jsxs(O,{children:[s&&a.jsx(B,{style:{display:"block",marginTop:"0.25rem",textAlign:"left"},children:s}),a.jsxs(G,{stacked:n.stacked,$error:!!s,children:[a.jsx(J,{children:a.jsx(H,{})}),a.jsx("input",{ref:x,id:"email-input",className:"login-method-button",type:"email",placeholder:"your@email.com",onFocus:()=>k(!0),onChange:r=>y(r.target.value),onKeyUp:r=>{r.key==="Enter"&&u()},value:i,autoComplete:"email"}),w!=="email"||b?n.stacked?a.jsx("span",{}):a.jsx(V,{isSubmitting:o,onClick:u,disabled:S,children:"Submit"}):a.jsx(_,{color:"gray",children:"Recent"})]})]}),n.stacked?a.jsx(W,{loadingText:null,loading:o,disabled:S,onClick:u,style:{width:"100%"},children:"Submit"}):null]})}));let O=K,G=z,J=N(q)`
  display: inline-flex;
`;export{ae as j};
