import{dc as G,d7 as M,ef as J,d5 as K,d6 as Q,d9 as l,dg as k,d4 as n,de as W,d3 as g,eg as X}from"./index-BZUZJG0z.js";import{m as _,b as Z}from"./ModalHeader-D5psNgrf-BlEKM6aB.js";import{d as ee}from"./Layouts-BlFm53ED-D8gWrHLU.js";import{C as re}from"./QrCode-Bp7vKyXB-Dl74PJZb.js";import{t as ae}from"./FundWalletMethodHeader-CI5afzwL-BZtXSULE.js";import{i as ne}from"./InfoBanner-Dk1KghcK-BNIKeKfi.js";import{r as se}from"./Subtitle-CV-2yKE4-D-H5V56C.js";import{e as te}from"./Title-BnzYV3Is-BkAZi-Pa.js";import{j as ie}from"./WalletInfoCard-BtliVaf0-C-OpDWgj.js";import{s as oe}from"./useWalletBalance-CkNw6kj0-ciB7llZS.js";import{t as U}from"./analytics-mkkvFRju-DOXuftJB.js";import{e as de}from"./getChainName-DjpPdUSc-c2urPd0g.js";import{r as C}from"./getUsdcMintAddress-DFI1hv05-jlhpBW9a.js";import{t as ce}from"./transaction-CnfuREWo-nROljJQP.js";import{n as le}from"./getErc20Balance-CaKjNAs9-UsIHWji5.js";import{i as x,t as ue}from"./formatters-BCBPo00w.js";import"./dijkstra-COg3n3zL.js";import"./ErrorMessage-D8VaAP5m-C-TFvMaa.js";import"./LabelXs-oqZNqbm_-D0IQxw2J.js";import"./Address-BGlhcEcA-BeY89XEP.js";import"./check-BDT86Nu8.js";import"./createLucideIcon-B72mi0g_.js";import"./copy-PrcWgVQF.js";import"./shared-FM0rljBt-CEF3ZWm_.js";import"./getFormattedUsdFromLamports-B6EqSEho-C-HCdwKa.js";const Le={component:()=>{var D,b,w;let{wallets:m}=G(),{connectors:E}=M(),B=E.filter(J).flatMap((r=>r.wallets)),{data:s,setModalData:O,navigate:R,lastScreen:L}=K(),{rpcConfig:v,appId:y,createAnalyticsEvent:S,closePrivyModal:P}=M(),$=Q(),[a,p]=l.useState(void 0),[q,T]=l.useState(!1),e=s==null?void 0:s.funding,{reloadBalance:N}=oe({rpcConfig:v,appId:y,address:e.chainType==="ethereum"?e.address:void 0,chain:e.chainType==="ethereum"?e.chain:void 0}),u=e.chainType==="solana",f=u?e.isUSDC?"USDC":"SOL":e.erc20Address?(D=e.erc20ContractInfo)==null?void 0:D.symbol:e.chain.nativeCurrency.symbol,d=u?B.find((({address:r})=>r===e.address)):m.find((({address:r})=>k(r)===k(e.address)));if(!e)return O({errorModalData:{error:Error("Couldn't find funding config"),previousScreen:L||"FundingMethodSelectionScreen"},funding:s==null?void 0:s.funding,solanaFundingData:s==null?void 0:s.solanaFundingData,sendTransaction:s==null?void 0:s.sendTransaction}),R("ErrorScreen"),n.jsx(n.Fragment,{});l.useEffect((()=>{let r=u?async function(){if(e.chainType!=="solana")return;let t=$.solanaRpcs[e.chain];t?(e.isUSDC?(async function({rpc:c,address:i,mintAddress:V}){var F;let Y=await c.getTokenAccountsByOwner(i,{mint:V},{encoding:"jsonParsed",commitment:"confirmed"}).send(),A=(F=Y.value[0])==null?void 0:F.account;return A?BigInt(A.data.parsed.info.tokenAmount.amount):0n})({rpc:t.rpc,address:e.address,mintAddress:C(e.chain)}):W({rpc:t.rpc,address:e.address})).then((c=>{let i=BigInt(c);a&&i>a&&(T(!0),S({eventName:U,payload:{provider:"manual",status:"success",chainType:"solana",address:d==null?void 0:d.address,value:e.isUSDC?g(i-a,6):g(i-a,9),token:e.isUSDC?"USDC":"SOL"}})),p(i)})):console.warn("Unable to load solana rpc, skipping balance")}:async function(){e.chainType==="ethereum"&&(async()=>{if(!e.erc20Address)return await N()??BigInt(0);{let{balance:t}=await le({chain:e.chain,address:e.address,erc20Address:e.erc20Address,rpcConfig:v,appId:y});return t}})().then((t=>{var c,i;a&&t>a&&(T(!0),S({eventName:U,payload:{provider:"manual",status:"success",chainType:"ethereum",address:d==null?void 0:d.address,chainId:e.chain.id,value:g(t-a,((c=e.erc20ContractInfo)==null?void 0:c.decimals)??18),token:((i=e.erc20ContractInfo)==null?void 0:i.symbol)??e.erc20Address??"ETH"}})),p(t)})).catch((()=>p(void 0)))},o=setInterval(r,2e3);return r(),()=>clearInterval(o)}),[a]);let z=l.useMemo((()=>{var r;return a==null?"":e.isUSDC?x({amount:a,decimals:6}):u?ce(a,3,!0,!0):((r=e.erc20ContractInfo)==null?void 0:r.decimals)!=null?x({amount:a,decimals:e.erc20ContractInfo.decimals}):ue({wei:a})}),[a,u,e]),h=e.chainType==="ethereum"?e.chain.name:de(e.chain),j=l.useMemo((()=>{var r,o;return((r=e.uiConfig)==null?void 0:r.receiveFundsTitle)===""?null:n.jsx(te,{children:((o=e.uiConfig)==null?void 0:o.receiveFundsTitle)??`Receive ${e.amount} ${f??""}`.trim()})}),[(b=e.uiConfig)==null?void 0:b.receiveFundsTitle,e.amount,f]),I=l.useMemo((()=>{var r,o;return((r=e.uiConfig)==null?void 0:r.receiveFundsSubtitle)===""?null:n.jsx(se,{children:((o=e.uiConfig)==null?void 0:o.receiveFundsSubtitle)??`Scan this code or copy your wallet address to receive funds on ${h}.`})}),[(w=e.uiConfig)==null?void 0:w.receiveFundsSubtitle,h]),H=e.chainType==="solana"&&e.isUSDC&&C(e.chain)?`?spl-token=${C(e.chain)}`:"";return n.jsxs(n.Fragment,{children:[n.jsx(ae,{}),j,I,n.jsxs(ee,{style:{gap:"1rem",margin:j||I?"1rem 0":"0"},children:[n.jsx(re,{url:`${e.chainType}:${e.address}${H}`,size:200,squareLogoElement:me}),n.jsxs(ne,{theme:$.appearance.palette.colorScheme,children:["Make sure to send funds on ",h,"."]}),n.jsx(ie,{title:"Your wallet",errMsg:void 0,showCopyButton:!0,balance:`${z} ${f}`,address:e.address}),q&&n.jsx(_,{onClick:()=>P({shouldCallAuthOnSuccess:!1,isSuccess:!0}),children:"Continue"})]}),n.jsx(Z,{})]})}};let me=({...m})=>n.jsx(X,{color:"black",...m});export{Le as ManualTransferScreen,Le as default};
