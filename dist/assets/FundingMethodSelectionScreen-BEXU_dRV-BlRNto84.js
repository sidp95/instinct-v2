import{eK as A,eN as E,eI as j,eJ as O,eP as T,eO as P,d9 as h,dc as te,d7 as q,ef as re,d5 as se,d6 as ie,fM as de,bI as K,dd as oe,d4 as a,eD as D,fN as J,fO as ce,df as le}from"./index-BZUZJG0z.js";import{F as he}from"./ArrowsRightLeftIcon-PAKpD01z.js";import{b as ue}from"./ModalHeader-D5psNgrf-BlEKM6aB.js";import{t as pe}from"./FundWalletMethodHeader-CI5afzwL-BZtXSULE.js";import{t as me}from"./ErrorBanner-CQERa7bL-DhK9Px_L.js";import{i as fe}from"./InfoBanner-Dk1KghcK-BNIKeKfi.js";import{e as ge}from"./WalletCards-DH1rqayz-D-vmqq6_.js";import{n as ve}from"./getErc20TokenInfo-BFoeg5F6-D2udEJiP.js";import{l as ye}from"./index-DEy_pO5S-DKQ5Zb2b.js";import{e as we,n as W,m as Ce,f as be}from"./styles-CaJCyFB5-BHZKprYK.js";import"./ExclamationCircleIcon-CTyaHNWt.js";import"./analytics-mkkvFRju-DOXuftJB.js";import"./LinkPasskeyScreen-DJveInKu-fpSMIaSF.js";import"./TodoList-CgrU7uwu-C9JMyp_T.js";import"./createLucideIcon-B72mi0g_.js";import"./check-BDT86Nu8.js";import"./ScreenLayout-DIdy7nhJ-CtKEKsly.js";import"./Screen-q8npRQhQ-DadJ2eBF.js";import"./index-Dq_xe9dz-CmgW7sSb.js";import"./circle-check-big-CartQiBB.js";import"./fingerprint-pattern-DCdiYDPD.js";let xe=new Set([A.id,E.id,O.id,j.id,T.id,P.id]),Me=new Set([A.id,E.id,j.id,O.id,T.id,P.id]),Fe={buy:"CARD",send:"CRYPTO_ACCOUNT"},je={USDC:"2b92315d-eab7-5bef-84fa-089a131333f5",ETH:"d85dce9b-5b73-5c3c-8978-522ce1d1c1b4",BTC:"5b71fc48-3dd3-540c-809b-f8c94d0e68b5",SOL:"4f039497-3af8-5bb3-951c-6df9afa9be1c",POL:"026bcc1e-9163-591c-a709-34dd18b2e7a1"};A.id+"",E.id+"",O.id+"",j.id+"",T.id+"",P.id+"";function Se({appId:n,input:e,amount:d,blockchain:c,asset:i,experience:p}){let r=new URL("https://pay.coinbase.com/buy/select-asset");return r.searchParams.set("appId",e.app_id),r.searchParams.set("sessionToken",e.session_token),r.searchParams.set("endPartnerName",`privy:${n}`),r.searchParams.set("defaultExperience",p),r.searchParams.set("presetCryptoAmount",d.startsWith(".")?`0${d}`:d),r.searchParams.set("defaultNetwork",c),r.searchParams.set("defaultPaymentMethod",Fe[p]),r.searchParams.set("defaultAsset",je[i]),r.searchParams.set("partnerUserId",e.partner_user_id),{url:r}}const ke=(n,e)=>{switch(e){case"native-currency":return xe.has(n);case"USDC":return Me.has(n);default:return console.warn("Unknown asset passed to Coinbase Onramp"),!1}};function De(n,e){return n===j.id?"POL":"ETH"}function We({title:n,titleId:e,...d},c){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":e},d),n?h.createElement("title",{id:e},n):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"}))}const Ae=h.forwardRef(We);function Ee({title:n,titleId:e,...d},c){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":e},d),n?h.createElement("title",{id:e},n):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z"}))}const Oe=h.forwardRef(Ee),Te=n=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 210.2",xmlSpace:"preserve",...n,children:a.jsx("path",{d:"M93.6,27.1C87.6,34.2,78,39.8,68.4,39c-1.2-9.6,3.5-19.8,9-26.1c6-7.3,16.5-12.5,25-12.9  C103.4,10,99.5,19.8,93.6,27.1 M102.3,40.9c-13.9-0.8-25.8,7.9-32.4,7.9c-6.7,0-16.8-7.5-27.8-7.3c-14.3,0.2-27.6,8.3-34.9,21.2  c-15,25.8-3.9,64,10.6,85c7.1,10.4,15.6,21.8,26.8,21.4c10.6-0.4,14.8-6.9,27.6-6.9c12.9,0,16.6,6.9,27.8,6.7  c11.6-0.2,18.9-10.4,26-20.8c8.1-11.8,11.4-23.3,11.6-23.9c-0.2-0.2-22.4-8.7-22.6-34.3c-0.2-21.4,17.5-31.6,18.3-32.2  C123.3,42.9,107.7,41.3,102.3,40.9 M182.6,11.9v155.9h24.2v-53.3h33.5c30.6,0,52.1-21,52.1-51.4c0-30.4-21.1-51.2-51.3-51.2H182.6z   M206.8,32.3h27.9c21,0,33,11.2,33,30.9c0,19.7-12,31-33.1,31h-27.8V32.3z M336.6,169c15.2,0,29.3-7.7,35.7-19.9h0.5v18.7h22.4V90.2  c0-22.5-18-37-45.7-37c-25.7,0-44.7,14.7-45.4,34.9h21.8c1.8-9.6,10.7-15.9,22.9-15.9c14.8,0,23.1,6.9,23.1,19.6v8.6l-30.2,1.8  c-28.1,1.7-43.3,13.2-43.3,33.2C298.4,155.6,314.1,169,336.6,169z M343.1,150.5c-12.9,0-21.1-6.2-21.1-15.7c0-9.8,7.9-15.5,23-16.4  l26.9-1.7v8.8C371.9,140.1,359.5,150.5,343.1,150.5z M425.1,210.2c23.6,0,34.7-9,44.4-36.3L512,54.7h-24.6l-28.5,92.1h-0.5  l-28.5-92.1h-25.3l41,113.5l-2.2,6.9c-3.7,11.7-9.7,16.2-20.4,16.2c-1.9,0-5.6-0.2-7.1-0.4v18.7C417.3,210,423.3,210.2,425.1,210.2z"})}),Pe=n=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 80 38.1",xmlSpace:"preserve",...n,children:[a.jsx("path",{style:{fill:"#5F6368"},d:"M37.8,19.7V29h-3V6h7.8c1.9,0,3.7,0.7,5.1,2c1.4,1.2,2.1,3,2.1,4.9c0,1.9-0.7,3.6-2.1,4.9c-1.4,1.3-3.1,2-5.1,2  L37.8,19.7L37.8,19.7z M37.8,8.8v8h5c1.1,0,2.2-0.4,2.9-1.2c1.6-1.5,1.6-4,0.1-5.5c0,0-0.1-0.1-0.1-0.1c-0.8-0.8-1.8-1.3-2.9-1.2  L37.8,8.8L37.8,8.8z"}),a.jsx("path",{style:{fill:"#5F6368"},d:"M56.7,12.8c2.2,0,3.9,0.6,5.2,1.8s1.9,2.8,1.9,4.8V29H61v-2.2h-0.1c-1.2,1.8-2.9,2.7-4.9,2.7  c-1.7,0-3.2-0.5-4.4-1.5c-1.1-1-1.8-2.4-1.8-3.9c0-1.6,0.6-2.9,1.8-3.9c1.2-1,2.9-1.4,4.9-1.4c1.8,0,3.2,0.3,4.3,1v-0.7  c0-1-0.4-2-1.2-2.6c-0.8-0.7-1.8-1.1-2.9-1.1c-1.7,0-3,0.7-3.9,2.1l-2.6-1.6C51.8,13.8,53.9,12.8,56.7,12.8z M52.9,24.2  c0,0.8,0.4,1.5,1,1.9c0.7,0.5,1.5,0.8,2.3,0.8c1.2,0,2.4-0.5,3.3-1.4c1-0.9,1.5-2,1.5-3.2c-0.9-0.7-2.2-1.1-3.9-1.1  c-1.2,0-2.2,0.3-3,0.9C53.3,22.6,52.9,23.3,52.9,24.2z"}),a.jsx("path",{style:{fill:"#5F6368"},d:"M80,13.3l-9.9,22.7h-3l3.7-7.9l-6.5-14.7h3.2l4.7,11.3h0.1l4.6-11.3H80z"}),a.jsx("path",{style:{fill:"#4285F4"},d:"M25.9,17.7c0-0.9-0.1-1.8-0.2-2.7H13.2v5.1h7.1c-0.3,1.6-1.2,3.1-2.6,4v3.3H22C24.5,25.1,25.9,21.7,25.9,17.7z"}),a.jsx("path",{style:{fill:"#34A853"},d:"M13.2,30.6c3.6,0,6.6-1.2,8.8-3.2l-4.3-3.3c-1.2,0.8-2.7,1.3-4.5,1.3c-3.4,0-6.4-2.3-7.4-5.5H1.4v3.4  C3.7,27.8,8.2,30.6,13.2,30.6z"}),a.jsx("path",{style:{fill:"#FBBC04"},d:"M5.8,19.9c-0.6-1.6-0.6-3.4,0-5.1v-3.4H1.4c-1.9,3.7-1.9,8.1,0,11.9L5.8,19.9z"}),a.jsx("path",{style:{fill:"#EA4335"},d:"M13.2,9.4c1.9,0,3.7,0.7,5.1,2l0,0l3.8-3.8c-2.4-2.2-5.6-3.5-8.8-3.4c-5,0-9.6,2.8-11.8,7.3l4.4,3.4  C6.8,11.7,9.8,9.4,13.2,9.4z"})]}),Q=n=>{let[e,d]=h.useState();return h.useEffect((()=>{n().then((c=>{d(c)})).catch((()=>{}))}),[]),e};function $e(n){let e=Le[n];if(!e)throw new le(`Unsupported chainId: ${n} for Coinbase Onramp`);return e}let Le={[A.id]:"ethereum",[E.id]:"base",[O.id]:"optimism",[j.id]:"polygon",[T.id]:"arbitrum",[P.id]:"avacchain"};const G=(n,e,d,c,i,p)=>new Promise((async(r,m)=>{let t=J();if(!t)return void m(Error("Unable to initialize flow"));let v=e.chainType==="ethereum"?$e(e.chain.id):"solana",y=e.isUSDC?"USDC":e.chainType==="ethereum"?De(e.chain.id):"SOL",g=await n.initCoinbaseOnRamp({addresses:[{address:e.address,blockchains:[v]}],assets:[y]}),{url:s}=Se({appId:n.getAppId(),input:g,amount:e.amount,blockchain:v,asset:y,experience:p});t.location=s.toString();let o={...i==null?void 0:i.funding,showAlternateFundingMethod:!0};e.usingDefaultFundingMethod&&(o.usingDefaultFundingMethod=!1),d({funding:o,solanaFundingData:i==null?void 0:i.solanaFundingData,coinbaseOnrampStatus:{popup:t}}),c("CoinbaseOnrampStatusScreen"),n.createAnalyticsEvent({eventName:"sdk_fiat_on_ramp_started",payload:{provider:"coinbase-onramp",value:e.amount,chainType:e.chainType,chainId:e.chainType==="ethereum"?e.chain.id:e.chain}}),setTimeout((()=>{d({funding:o,solanaFundingData:i==null?void 0:i.solanaFundingData,coinbaseOnrampStatus:{partnerUserId:g.partner_user_id,popup:t}})}),5e3),r()})),Ie=async(n,e,d,c,i,p,r,m)=>{let t=J();if(!t)throw Error("Unable to initialize flow");let v=e.chainType==="ethereum"?ce(e.chain.id,c):e.isUSDC?"USDC_SOL":"SOL",{signedUrl:y,externalTransactionId:g}=await n.signMoonpayOnRampUrl({address:e.address,useSandbox:d.fundingMethodConfig.moonpay.useSandbox??!1,config:{uiConfig:{accentColor:d.appearance.palette.accent,theme:d.appearance.palette.colorScheme},paymentMethod:m,currencyCode:v,quoteCurrencyAmount:ye(e.amount)}});n.createAnalyticsEvent({eventName:"sdk_fiat_on_ramp_started",payload:{provider:"moonpay",value:e.amount,chainType:e.chainType,chainId:e.chainType==="ethereum"?e.chain.id:e.chain}}),t.location=y;let s={...r==null?void 0:r.funding,showAlternateFundingMethod:!0};e.usingDefaultFundingMethod&&(s.usingDefaultFundingMethod=!1),i({moonpayStatus:{},funding:s,solanaFundingData:r==null?void 0:r.solanaFundingData}),p("MoonpayStatusScreen"),setTimeout((()=>{i({moonpayStatus:{externalTransactionId:g},funding:s,solanaFundingData:r==null?void 0:r.solanaFundingData})}),8e3)};let X=async n=>typeof window<"u"&&"PaymentRequest"in window&&await new window.PaymentRequest([{supportedMethods:n}],{id:"0",total:{label:"Item",amount:{currency:"USD",value:"1.00"}}}).canMakePayment();const _e=()=>X("https://apple.com/apple-pay"),ze=()=>X("https://google.com/pay"),da={component:()=>{var z,R,Z,H;let{wallets:n}=te(),{connectors:e}=q(),d=e.filter(re).flatMap((u=>u.wallets)),{navigate:c,data:i,setModalData:p}=se(),{client:r}=q(),m=ie(),t=i==null?void 0:i.funding,v=Q(_e),y=Q(ze),g=t.chainType==="solana",s=g?void 0:t,o=h.useMemo((()=>((u,C,l,b,k,x)=>{var V;let U,N,L=l.chainType==="solana",I=L?void 0:l,M=l.isUSDC?"USDC":I!=null&&I.erc20Address?void 0:"native-currency",ae=!!L||M&&de(Number(l.chain.id),M),B=!!L||M&&ke(Number(l.chain.id),M),_=[];for(let f of(l.preferredCardProvider&&l.supportedOptions.sort((ne=>ne.provider===l.preferredCardProvider?-1:1)),l.supportedOptions))f.method==="card"&&f.provider==="coinbase"&&B&&_.push((()=>G(C,l,b,k,x,"buy"))),f.method==="card"&&f.provider==="moonpay"&&ae&&M&&_.push((()=>Ie(C,l,u,M,b,k,x,"credit_debit_card")));for(let f of l.supportedOptions)f.method==="exchange"&&f.provider==="coinbase"&&B&&(U=()=>G(C,l,b,k,x,"buy"));for(let f of((V=x==null?void 0:x.funding)==null?void 0:V.supportedOptions)??[])f.method==="wallets"&&(N=()=>k("TransferFromWalletScreen"));return{onFundWithCard:_,onFundWithExchange:U,onFundWithWallet:N}})(m,r,t,p,c,i)),[m,r,t,i,p,c]),F=g?d.find((({address:u})=>u===t.address)):n.find((({address:u})=>K(u)===K(t.address))),$=oe((F==null?void 0:F.walletClientType)||"unknown"),Y=($==null?void 0:$.name)||"wallet",w=F&&F.walletClientType!=="privy"?Y:m.name,ee=h.useMemo((()=>{var u,C,l,b;return(C=(u=t.uiConfig)==null?void 0:u.landing)!=null&&C.title?(b=(l=t.uiConfig)==null?void 0:l.landing)==null?void 0:b.title:`Add funds to your ${w!=null&&w.toLowerCase().endsWith("wallet")?w:w+" wallet"}`}),[(R=(z=t.uiConfig)==null?void 0:z.landing)==null?void 0:R.title,w]);h.useEffect((()=>{if(t!=null&&t.defaultFundingMethod&&t.usingDefaultFundingMethod)switch(p({funding:{...t,usingDefaultFundingMethod:!1},solanaFundingData:i==null?void 0:i.solanaFundingData}),t==null?void 0:t.defaultFundingMethod){case"card":o.onFundWithCard[0]&&o.onFundWithCard[0]();break;case"exchange":o.onFundWithExchange&&o.onFundWithExchange();break;case"wallet":o.onFundWithWallet&&o.onFundWithWallet();break;case"manual":c("ManualTransferScreen")}}),[]),h.useEffect((()=>{s!=null&&s.erc20Address&&!s.erc20ContractInfo&&ve({address:s.erc20Address,chain:s.chain,rpcConfig:m.rpcConfig,privyAppId:m.id}).then((u=>{p({...i,funding:{...s,erc20ContractInfo:u?{symbol:u.symbol,decimals:u.decimals}:void 0}})})).catch(console.error)}),[s==null?void 0:s.erc20Address,s==null?void 0:s.chain]);let S=!(!(s!=null&&s.erc20Address)||s!=null&&s.erc20ContractInfo);return a.jsxs(a.Fragment,{children:[a.jsx(pe,{}),a.jsx("h3",{children:ee}),a.jsxs(we,{children:[t.errorMessage&&a.jsx(me,{theme:m.appearance.palette.colorScheme,children:t.errorMessage}),((Z=o.onFundWithCard)==null?void 0:Z[0])&&a.jsxs(D,{disabled:S,onClick:o.onFundWithCard[0],children:[a.jsx(W,{children:a.jsx(Ae,{style:{width:24}})}),"Pay with card",v?a.jsx(Te,{style:{marginLeft:"auto",maxWidth:"100%",width:"auto",height:"0.875rem"}}):y?a.jsx(Pe,{style:{marginLeft:"auto",maxWidth:"100%",width:"auto",height:"0.875rem"}}):null]}),o.onFundWithExchange&&a.jsxs(D,{disabled:S,onClick:o.onFundWithExchange,children:[a.jsx(W,{children:a.jsx(he,{style:{width:24}})}),"Transfer from an exchange"]}),o.onFundWithWallet&&a.jsxs(D,{disabled:S,onClick:o.onFundWithWallet,children:[a.jsx(W,{children:a.jsx(ge,{style:{width:24}})}),"Transfer from wallet"]}),a.jsxs(D,{disabled:S,onClick:()=>c("ManualTransferScreen"),children:[a.jsx(W,{children:a.jsx(Oe,{style:{width:24}})}),"Receive funds"]}),(t==null?void 0:t.showAlternateFundingMethod)&&((H=o.onFundWithCard)==null?void 0:H[1])&&a.jsx(fe,{theme:m.appearance.palette.colorScheme,children:a.jsxs(Ce,{children:["Having trouble or facing location restrictions?"," ",a.jsx(be,{onClick:o.onFundWithCard[1],children:"Try a different provider."})]})})]}),a.jsx(ue,{})]})}};export{da as FundingMethodSelectionScreen,da as default};
