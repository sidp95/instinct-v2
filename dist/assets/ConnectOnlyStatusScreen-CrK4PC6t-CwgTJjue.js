import{d4 as C,d5 as q,d7 as z,d9 as w,dd as F,dw as O,dx as X,dy as Y,dz as A}from"./index-BZUZJG0z.js";import{n as G}from"./ScreenLayout-DIdy7nhJ-CtKEKsly.js";import{getErrorDetails as H}from"./ConnectionStatusScreen-KrobwyOT-CUHAevnL.js";import"./ModalHeader-D5psNgrf-BlEKM6aB.js";import"./Screen-q8npRQhQ-DadJ2eBF.js";import"./index-Dq_xe9dz-CmgW7sSb.js";import"./Link-DJ5gq9Di-HJKsU0YK.js";import"./useI18n-CD7HCIxK-CHc5ankF.js";import"./shouldProceedtoEmbeddedWalletCreationFlow-D0uaMzCB-ChwW2HLS.js";const J=({walletLogo:d,success:i,errorMessage:t,title:p,subtitle:f,onRetry:o,onUseDifferentWallet:u,onBack:e,numRetries:r,maxRetries:n})=>C.jsx(G,{title:p,subtitle:f,icon:d,iconVariant:"loading",iconLoadingStatus:{success:i,fail:!!t},primaryCta:t===A.ERROR_USER_EXISTS?{label:"Use a different wallet",onClick:u}:!i&&(t!=null&&t.retryable)&&r<n?{label:"Retry",onClick:o,disabled:!(t!=null&&t.retryable)||r>=n}:!i&&t&&r>=n?{label:"Use a different wallet",onClick:u}:void 0,onBack:e,watermark:!0}),le={component:()=>{var R,T,v,x,_,B,M;let d,{navigateBack:i,navigate:t,lastScreen:p,currentScreen:f,data:o,setModalData:u}=q(),{walletConnectionStatus:e,closePrivyModal:r}=z(),[n,b]=w.useState(void 0),[g,L]=w.useState(0),a=F(((R=e==null?void 0:e.connector)==null?void 0:R.walletClientType)||"unknown"),c=(e==null?void 0:e.status)==="connected",k=(e==null?void 0:e.status)==="switching_to_supported_chain";w.useEffect((()=>{var s,W;if(c){let y;if((s=o==null?void 0:o.externalConnectWallet)!=null&&s.onCompleteNavigateTo){let I=o.externalConnectWallet.onCompleteNavigateTo,U=(W=e.connectedWallet)==null?void 0:W.address;y=setTimeout((()=>{var D,N;if(o.funding&&e.connector){let P=e.connector.wallets.find((V=>V.address===U));u({...o,funding:{...o.funding,connectedWallet:P}})}t(I({address:U,walletClientType:(D=e.connector)==null?void 0:D.walletClientType,walletChainType:(N=e.connector)==null?void 0:N.chainType}))}),O)}else y=setTimeout(r,O);return()=>clearTimeout(y)}}),[c]),w.useEffect((()=>{var s;e!=null&&e.connectError&&(s=e==null?void 0:e.connectError,b(H(s)))}),[e]);let S=((T=e==null?void 0:e.connector)==null?void 0:T.connectorType)||"injected",h=((v=e==null?void 0:e.connector)==null?void 0:v.walletClientType)||"unknown",m=((x=a==null?void 0:a.metadata)==null?void 0:x.shortName)||(a==null?void 0:a.name)||((_=e==null?void 0:e.connector)==null?void 0:_.walletBranding.name)||"Browser Extension",$=((B=a==null?void 0:a.image_url)==null?void 0:B.md)||((M=e==null?void 0:e.connector)==null?void 0:M.walletBranding.icon)||(s=>C.jsx(X,{...s})),E=m==="Browser Extension"?m.toLowerCase():m;d=c?`Successfully connected with ${E}`:n?n.message:k?"Switching networks":`Waiting for ${E}`;let l="Don’t see your wallet? Check your other browser windows.";return c?l="You’re good to go!":g>=2&&n?l="Unable to connect wallet":n?l=n.detail:k?l="Switch your wallet to the requested network.":h==="metamask"&&Y.isMobile?l="Click to continue to open and connect MetaMask.":h==="metamask"?l="For the best experience, connect only one wallet at a time.":S==="wallet_connect_v2"?l="Open your mobile wallet app to continue":S==="coinbase_wallet"&&(l="Confirm in the Coinbase app/popup to continue."),C.jsx(J,{walletName:m,walletLogo:$,success:c,errorMessage:n,title:d,subtitle:l,onRetry:()=>{L(g+1),b(void 0),e==null||e.connectRetry()},onUseDifferentWallet:i,onBack:f===p?void 0:i,numRetries:g,maxRetries:2})}};export{le as ConnectOnlyStatusScreen,J as ConnectOnlyStatusScreenView,le as default};
