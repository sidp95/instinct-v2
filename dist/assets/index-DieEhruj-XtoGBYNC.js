import{d5 as Tt,d7 as J,dA as ht,d6 as gt,d9 as s,d4 as l,dG as Be,m as It,r as vt,et as xt,eu as kt,dg as Et,d1 as Mt,dw as St,ev as qe,ew as Ue,ex as Ft,ey as _t,bw as Ct,bt as wt,cl as Nt,ds as Ve}from"./index-BZUZJG0z.js";import{d as Re}from"./Address-BGlhcEcA-BeY89XEP.js";import{c as $t}from"./useGetTokenPrice-C1-pGMgN-DqVN8PHa.js";import{s as At}from"./useWalletBalance-CkNw6kj0-ciB7llZS.js";import{n as jt}from"./getErc20TokenInfo-BFoeg5F6-D2udEJiP.js";import{t as Rt}from"./formatErc20TokenAmount-BuPk9xcy-CkAr4Oc0.js";import{c as Oe,o as Y,i as Ot}from"./ethers-TpFbevgv-CT39HWSi.js";import{ErrorScreenView as Dt}from"./ErrorScreen-DLsfgpC9-DwaPA2-1.js";import{T as Ge,b as He,m as Pt}from"./ModalHeader-D5psNgrf-BlEKM6aB.js";import{a as Bt}from"./JsonTree-aPaJmPx7-3xUCUB5b.js";import{n as qt,Q as Ut}from"./TransactionErrorView-CkMh0sTl-B3eKaaR4.js";import{s as Vt}from"./Layouts-BlFm53ED-D8gWrHLU.js";import{n as Gt}from"./ScreenHeader-CHmc4-Lu-D968ig42.js";import{$ as Ht}from"./TransactionDetails-DB8AH1mq-yGptQR4G.js";import{t as Lt}from"./transfer-CMPmjPsM-Cjofo3yZ.js";import{i as Wt}from"./formatters-BCBPo00w.js";import"./check-BDT86Nu8.js";import"./createLucideIcon-B72mi0g_.js";import"./copy-PrcWgVQF.js";import"./useGetSolPrice-Cfm8o9C5-DeeG65FR.js";import"./reservoir-kvLjIrEo-Do6elMp6.js";import"./ScreenLayout-DIdy7nhJ-CtKEKsly.js";import"./Screen-q8npRQhQ-DadJ2eBF.js";import"./index-Dq_xe9dz-CmgW7sSb.js";import"./lock-C--KDDhh.js";import"./Value-tcJV9e0L-Dbu4EDrR.js";import"./LoadingSkeleton-U6-3yFwI-BqvAdjZO.js";import"./ErrorMessage-D8VaAP5m-C-TFvMaa.js";import"./LabelXs-oqZNqbm_-D0IQxw2J.js";import"./Subtitle-CV-2yKE4-D-H5V56C.js";import"./Title-BnzYV3Is-BkAZi-Pa.js";import"./WalletInfoCard-BtliVaf0-C-OpDWgj.js";import"./shared-FM0rljBt-CEF3ZWm_.js";import"./Checkbox-BhNoOKjX-DF6rQPDu.js";import"./ErrorBanner-CQERa7bL-DhK9Px_L.js";import"./ExclamationCircleIcon-CTyaHNWt.js";import"./WarningBanner-c8L53pJ2-DNXOaIsr.js";import"./ExclamationTriangleIcon-CLH_TsZy.js";import"./ChevronDownIcon-k3TGnLFx.js";import"./WalletLink-foFywOfy-BZGpYybr.js";import"./getFormattedUsdFromLamports-B6EqSEho-C-HCdwKa.js";import"./transaction-CnfuREWo-nROljJQP.js";let Qt=[{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],zt=Ve.div`
  display: flex;
  flex-direction: column;
  min-height: 72px;
`;var Kt=({onBack:e,details:p})=>l.jsxs(zt,{children:[l.jsx(Ge,{backFn:e}),l.jsx(Bt,{data:p}),l.jsx(He,{})]});let Xt=({gasUsed:e,effectiveGasPrice:p})=>{if(e&&p)try{return Nt(e*p)}catch{return}};const Yt=({txn:e,receipt:p,transactionInfo:y,onClose:f,tokenPrice:v,tokenSymbol:h,receiptHeader:g,receiptDescription:b})=>l.jsxs(l.Fragment,{children:[l.jsx(Ge,{onClose:f}),l.jsx(Gt,{title:g??"Transaction complete!",description:b??"You're all set."}),l.jsx(Ht,{tokenPrice:v,from:p.from,to:p.to,gas:Xt(p),txn:e,transactionInfo:y,tokenSymbol:h}),l.jsx(_t,{}),l.jsx(Zt,{loading:!1,onClick:f,children:"All Done"}),l.jsx(Vt,{}),l.jsx(He,{})]});let Zt=Ve(Pt)`
  && {
    margin-top: 24px;
  }
  transition:
    color 350ms ease,
    background-color 350ms ease;
`;const Jt=[{constant:!1,inputs:[{name:"_salt",type:"bytes32"},{name:"_initializer",type:"bytes"}],name:"deployAccount",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],en=[{name:"from",type:"address"},{name:"param2",type:"address"},{name:"param3",type:"bytes"},{name:"param4",type:"tuple",components:[]},{type:"tuple",components:[{name:"param5",type:"address"},{name:"param6",type:"uint256"},{name:"param7",type:"uint256"},{name:"encodedInitData",type:"bytes"}]}],tn=[{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],nn=[{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"quantity",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"quantity",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"quantities",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mintBatch",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"quantities",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mintBatch",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"batchMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"batchMint",outputs:[],stateMutability:"payable",type:"function"}],an=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],sn=[{constant:!1,inputs:[{name:"_operator",type:"address"},{name:"_approved",type:"bool"}],name:"setApprovalForAll",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],rn=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],on=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenIds",type:"uint256[]"},{name:"_amounts",type:"uint256[]"},{name:"_data",type:"bytes"}],name:"safeBatchTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],ln=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"},{name:"_amount",type:"uint256"},{name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Le=(e,p)=>{let y=S(tn,e);if(y)return{action:"approve",functionName:"approve",isErc20Ish:!0,isNFTIsh:!1,spender:y.args[0],amount:y.args[1]};let f=S(Lt,e);if(f)return{action:"transfer",functionName:"transfer",isErc20Ish:!0,isNFTIsh:!1,transferTo:f.args[0],amount:f.args[1]};if(!p)return{action:"transaction",functionName:"",isErc20Ish:!1,isNFTIsh:!1};let v=S(Jt,e);if(v&&typeof v.args[1]=="string"){let r=un(v.args[1]);if(r&&r[4].encodedInitData)return Le(r[4].encodedInitData,p)}let h=S(sn,e);if(h)return{action:"approve",functionName:"setApprovalForAll",isNFTIsh:!0,isErc20Ish:!1,operator:h.args[0],approved:h.args[1]};let g=S(rn,e);if(g)return{action:"transfer",functionName:"transferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:g.args[0],transferTo:g.args[1],tokenId:g.args[2]};let b=S(an,e);if(b)return{action:"transfer",functionName:"safeTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:b.args[0],transferTo:b.args[1],tokenId:b.args[2]};let x=S(ln,e);if(x)return{action:"transfer",functionName:"safeTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:x.args[0],transferTo:x.args[1],tokenId:x.args[2],amount:x.args[3]};let t=S(on,e);if(t)return{action:"batch transfer",functionName:"safeBatchTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:t.args[0],transferTo:t.args[1],tokenIds:t.args[2],amounts:t.args[3]};let i=S(nn,e);return i?{action:"mint",functionName:i.functionName,isNFTIsh:!0,isErc20Ish:!1,args:i.args}:{action:"transaction",isErc20Ish:!1,isNFTIsh:!1}};let S=(e,p)=>{try{let y=Ct({abi:e,data:p});return{functionName:y.functionName,args:y.args||[]}}catch{return null}},un=e=>{try{if(typeof e=="string")return wt(en,`0x${e.slice(10)}`)}catch{return null}},Z=e=>`${parseFloat(e).toFixed(2)}`;function pn(e,p){var v,h,g,b,x;let y=[],f=new Map;if(e){for(let t of e)if(t.in[0]){let i;i=t.asset.type==="ERC721"||t.in[0].value==="approve_for_all"?{id:`nft:${t.asset.name}`,nftName:t.asset.name,nftCount:t.in.length}:{id:`token:${t.asset.type}:${t.asset.symbol}:${t.asset.name}`,iconUrl:t.asset.logo_url,value:t.in[0].value,symbol:t.asset.symbol,usdValue:t.in[0].usd_price?Z(t.in[0].usd_price):void 0,decimals:t.asset.decimals},y.push(i)}else if((v=t.out[0])!=null&&v.value){let i;i=t.asset.type==="ERC721"||t.out[0].value==="approve_for_all"?{id:`nft:${t.asset.name}`,nftName:t.asset.name}:{id:`token:${t.asset.type}:${t.asset.symbol}:${t.asset.name}`,iconUrl:t.asset.logo_url,value:t.out[0].value,symbol:t.asset.symbol,usdValue:t.out[0].usd_price?Z(t.out[0].usd_price):void 0,decimals:t.asset.decimals},f.has(i.id)||f.set(i.id,i)}}for(let t of p)for(let i of Object.keys(t.spenders)){let r;r=t.asset.type==="ERC721"||((h=t.spenders[i])==null?void 0:h.value)==="approve_for_all"?{id:`nft:${t.asset.name}`,nftName:t.asset.name}:{id:`token:${t.asset.type}:${t.asset.symbol}:${t.asset.name}`,iconUrl:t.asset.logo_url,value:(g=t.spenders[i])==null?void 0:g.value,symbol:t.asset.symbol,usdValue:(b=t.spenders[i])!=null&&b.usd_price?Z((x=t.spenders[i])==null?void 0:x.usd_price):void 0,decimals:t.asset.decimals},f.has(r.id)||f.set(r.id,r)}return{assetsIn:y,assetsOut:Array.from(f.values())}}const dn=(e,p,y,f)=>{let[v,h]=s.useState(null),{walletProxy:g}=J();return s.useEffect((()=>{v&&h(null),(async()=>{if(!g||!p)return null;let b=[],x=!0,t=await Ft(e,y,p,f).catch((i=>(i.message&&i.message.includes("Insufficient balance for transaction")||i.message&&i.message.includes("Insufficient funds for gas * price + value")||i.details&&i.details.includes("insufficient funds")?x=!1:b.push(i),e)));return{tx:t,totalGasEstimate:t.gas,hasFunds:x,errors:b}})().then(h)}),[e]),v};let De=new Be(new qe("There was an issue preparing your transaction",Ue.E32603_DEFAULT_INTERNAL_ERROR.eipCode)),Pe=(e,p)=>e!=null&&e.sendTransaction?"transactionRequest"in e.sendTransaction?e.sendTransaction.transactionRequest:e.sendTransaction.transactionRequests[p]:void 0;const ea={component:()=>{var fe,be,Te,he,ge,Ie,ve,xe,ke,Ee,Me,Se,Fe,_e,Ce,we,Ne,$e;let{data:e,onUserCloseViaDialogOrKeybindRef:p,setModalData:y,navigate:f}=Tt(),{client:v,rpcConfig:h,chains:g,closePrivyModal:b,walletProxy:x,showFiatPrices:t}=J(),{user:i}=ht(),r=gt(),[E,ee]=s.useState(0),[O,We]=s.useState(0),[d,te]=s.useState(Pe(e,E)),[k,Qe]=s.useState(null),[ne,ae]=s.useState(),[V,se]=s.useState(!1),[G,ze]=s.useState(null),[ie,Ke]=s.useState(null),[$,re]=s.useState(null),[H,Xe]=s.useState(void 0),[Ye,L]=s.useState(void 0),[Ze,oe]=s.useState(!1),[le,ue]=s.useState(!1),[Je,D]=s.useState([]),[et,tt]=s.useState([]),[P,W]=s.useState("uninitiated"),[nt,at]=s.useState(void 0);if(!d||!(e!=null&&e.sendTransaction)||!(e!=null&&e.sendTransaction))return l.jsx(Dt,{error:Error("Invalid transaction request"),allowlistConfig:r.allowlistConfig,onRetry:()=>{var a;(a=e==null?void 0:e.sendTransaction)==null||a.onFailure(De),b({shouldCallAuthOnSuccess:!1})}});let{transactingWalletAddress:A}=e.sendTransaction,T=s.useMemo((()=>g.find((a=>Number(a.id)===Number(d.chainId)))),[d.chainId]),j=(T==null?void 0:T.nativeCurrency.symbol)??"ETH",I=s.useMemo((()=>Le(d.data,!!r.embeddedWallets.extendedCalldataDecoding)),[d.data]),{action:F,isErc20Ish:w,isNFTIsh:st,functionName:B}=I,{toAddress:it,tokenAddress:pe}=s.useMemo((()=>({toAddress:I.isErc20Ish?I.transferTo:d.to??void 0,tokenAddress:I.isErc20Ish?d.to:void 0})),[I]);s.useEffect((()=>{d.to&&T&&w&&jt({address:d.to,chain:T,rpcConfig:r.rpcConfig,privyAppId:r.id}).then(Qe).catch(console.error)}),[d.to,T]);let{tokenPrice:_,isTokenPriceLoading:rt}=$t(d.chainId),{balance:de}=At({rpcConfig:r.rpcConfig,appId:r.id,address:A,chain:T}),ce=(function({rpcConfig:a,appId:o,address:c,chain:m,tokenInfo:u}){let{chains:M}=J(),[N,U]=s.useState(null),[R,Ae]=s.useState(!1),X=s.useMemo((()=>{let C=m||M[0];if(C)return It({chain:m,transport:vt(xt(C,a,o))})}),[m,a,o]),je=s.useCallback((async()=>{if(c&&X&&u.address)try{return Ae(!0),await X.readContract({address:u.address,abi:Qt,functionName:"balanceOf",args:[c]})}catch(C){console.error(C)}finally{Ae(!1)}}),[X,c,u==null?void 0:u.address,m]);return s.useEffect((()=>{je().then((C=>C!=null&&U(C)))}),[je]),{balance:N,isLoading:R&&N==null,formattedBalance:Wt({amount:N??BigInt(0),decimals:u.decimals})}})({rpcConfig:r.rpcConfig,appId:r.id,address:A,tokenInfo:{address:pe||"",decimals:(k==null?void 0:k.decimals)??18},chain:T}),me=s.useMemo((()=>kt(Number(d.chainId),g,h,{appId:r.id})),[d.chainId,h]),n=dn(d,A,me,(fe=e==null?void 0:e.sendTransaction)==null?void 0:fe.prepareTransactionRequest);s.useEffect((()=>{te(Pe(e,E))}),[E]),s.useEffect((()=>{var a;(a=e.sendTransaction)!=null&&a.getIsSponsored?e.sendTransaction.getIsSponsored().then(ae).catch(console.error):ae(!1)}),[e.sendTransaction.getIsSponsored]);let q=()=>{var a,o,c;if(!V)return G?(a=e==null?void 0:e.sendTransaction)==null||a.onSuccess({hash:G}):$||n!=null&&n.errors[0]?(o=e==null?void 0:e.sendTransaction)==null||o.onFailure($??(n==null?void 0:n.errors[0])??De):(c=e==null?void 0:e.sendTransaction)==null||c.onFailure(new Be(new qe("The user rejected the request",Ue.E4001_USER_REJECTED_REQUEST.eipCode))),b({shouldCallAuthOnSuccess:!1})};p.current=q;let Q=!!(e.funding&&e.funding.supportedOptions.length>0),ot=Oe(BigInt((n==null?void 0:n.totalGasEstimate)??0n),j),lt=t&&_?Y(BigInt((n==null?void 0:n.totalGasEstimate)??0n),_):void 0,ut=Oe(de??0n,j,void 0,!0),pt=t&&_?Y(de??0n,_):void 0,dt=k&&!ce.isLoading&&w&&F!=="approve"?`${ce.formattedBalance} ${k.symbol}`:void 0,z=(he=(Te=(be=e.sendTransaction)==null?void 0:be.uiOptions)==null?void 0:Te.transactionInfo)==null?void 0:he.title;z||(z=F==="approve"?w?"Confirm address":"Confirm action":`Approve ${F}`);let ct=s.useMemo((()=>{var a,o,c,m,u,M,N,U;if((o=(a=e.sendTransaction)==null?void 0:a.uiOptions)!=null&&o.description)return(m=(c=e.sendTransaction)==null?void 0:c.uiOptions)==null?void 0:m.description;if(F==="approve"&&B==="setApprovalForAll"&&I.approved){let R=l.jsx(Re,{address:I.operator||"",url:(M=(u=T==null?void 0:T.blockExplorers)==null?void 0:u.default)==null?void 0:M.url});return l.jsxs(l.Fragment,{children:[r.name," would like your permission for ",R," to transfer tokens on your behalf."]})}if(F==="approve"&&B==="setApprovalForAll"&&!I.approved){let R=l.jsx(Re,{address:I.operator||"",url:(U=(N=T==null?void 0:T.blockExplorers)==null?void 0:N.default)==null?void 0:U.url});return l.jsxs(l.Fragment,{children:[r.name," would like your permission to revoke permissions of ",R," from transferring tokens on your behalf."]})}return w&&F==="approve"||w&&F==="approve"?`${r.name} would like your permission for ${Et(I.spender)} to spend tokens on your behalf.`:`${r.name} wants your permission to approve the following transaction.`}),[r.name,w,I,(ge=e.sendTransaction)==null?void 0:ge.uiOptions.description,B]),mt=(ke=(xe=(ve=(Ie=e.sendTransaction)==null?void 0:Ie.uiOptions)==null?void 0:ve.transactionInfo)==null?void 0:xe.contractInfo)!=null&&ke.imgUrl?l.jsx("img",{src:e.sendTransaction.uiOptions.transactionInfo.contractInfo.imgUrl,alt:e.sendTransaction.uiOptions.transactionInfo.contractInfo.imgAltText}):null,K=!(!n||n.errors[0]||n.hasFunds||ne!==!1),ye=K&&Q,yt=ye?"Add funds":((Me=(Ee=e.sendTransaction)==null?void 0:Ee.uiOptions)==null?void 0:Me.buttonText)||(E<O?"Continue":"Approve"),ft=a=>{if(!a)throw Error("Transaction scan failed");if(a.validation.status==="Success"&&(a.validation.result_type==="Benign"?L("safe"):a.validation.result_type==="Warning"?L("warn"):a.validation.result_type==="Malicious"&&(L("error"),ue(!0))),a.simulation.status!=="Success")throw Error("Simulation failed");{Xe(a.simulation.params);let{assetsIn:o,assetsOut:c}=pn(a.simulation.assets_diffs,a.simulation.exposures);if(c.length===0&&o.length===0)throw Error("No tokens found");D(c),tt(o)}};if(s.useEffect((()=>{var a;(a=e.sendTransaction)!=null&&a.scanTransaction&&r.embeddedWallets.transactionScanning.enabled&&P==="uninitiated"&&(W("in progress"),e.sendTransaction.scanTransaction().then((o=>{ft(o),W("completed")})).catch((()=>W("failed"))))}),[!!((Se=e.sendTransaction)!=null&&Se.scanTransaction)]),s.useEffect((()=>{var a;(a=e.sendTransaction)!=null&&a.scanTransaction&&P!=="failed"||((o,c,m)=>{if(We((u=>u!=null&&u.sendTransaction?"transactionRequest"in u.sendTransaction?0:u.sendTransaction.transactionRequests.length-1:0)(e)),c.isErc20Ish&&c.amount&&m){let u=Rt({amount:c.amount,decimals:m.decimals});at(u),D([{value:u,symbol:m==null?void 0:m.symbol,decimals:m==null?void 0:m.decimals}])}else if(o.value){let u=BigInt(o.value),M=_?Y(u,_):void 0;D(t&&M?[{value:M}]:[{value:Ot(u),symbol:j,decimals:18,usdValue:M}])}else D(t?[{value:"$0"}]:[{value:"0",symbol:j,decimals:18}])})((n==null?void 0:n.tx)??d,I,k)}),[d,n==null?void 0:n.tx,I,k,P]),ie)return l.jsx(Yt,{txn:(n==null?void 0:n.tx)??d,onClose:q,receipt:ie,transactionInfo:(Fe=e.sendTransaction)==null?void 0:Fe.uiOptions.transactionInfo,tokenPrice:_,tokenSymbol:j,receiptHeader:(_e=e.sendTransaction)==null?void 0:_e.uiOptions.successHeader,receiptDescription:(Ce=e.sendTransaction)==null?void 0:Ce.uiOptions.successDescription});if($)return l.jsx(qt,{transactionError:$,transactionHash:G??void 0,chainType:"ethereum",chainId:(n==null?void 0:n.tx.chainId)??d.chainId,onClose:q,onRetry:({resetNonce:a})=>{re(null);let o={...(n==null?void 0:n.tx)??d};a&&(o.nonce=void 0),te(o)}});let bt=O!==0&&typeof E=="number"&&E!==0?()=>{ee(E-1)}:void 0;return Ze&&H?l.jsx(Kt,{details:H,onBack:()=>oe(!1)}):l.jsx(Ut,{transactionIndex:E,onBack:bt,maxIndex:O,disabled:K&&!Q||le,isSubmitting:V,submitError:$,isPreparing:!n,isTokenPriceLoading:rt,isTokenContractInfoLoading:!st&&!k,prepareError:n==null?void 0:n.errors[0],symbol:k==null?void 0:k.symbol,chain:T,img:mt,title:z,subtitle:ct,txValue:d.value,fee:lt??ot,isSponsored:ne,from:A??"",to:it,tokenAddress:pe??void 0,network:((we=r.chains.find((a=>a.id===d.chainId)))==null?void 0:we.name)??"",transactionDetails:{...I,formattedAmount:nt},cta:yt,missingFunds:K,action:F,balance:dt??pt??ut,onClose:q,onClick:ye?async()=>{var o;if(!A)return;if(!Q)throw Error("Funding wallet is not enabled");let a="FundingMethodSelectionScreen";y({...e,funding:{...e.funding,methodScreen:a,chainType:"ethereum",amount:Mt(BigInt((n==null?void 0:n.tx.value)??0)+BigInt(((o=n==null?void 0:n.totalGasEstimate)==null?void 0:o.toString())??0)),chain:T},solanaFundingData:e==null?void 0:e.solanaFundingData}),f(a)}:async()=>{var a,o;if(E<O)ee(E+1);else{se(!0);try{let c=await v.getAccessToken();if(V||!c||!x||!i)return;let m=await e.sendTransaction.onConfirm({transactionRequest:(n==null?void 0:n.tx)??d});if(ze(m),(a=e.sendTransaction)==null?void 0:a.signOnly)return await new Promise((M=>setTimeout(M,St))),(o=e==null?void 0:e.sendTransaction)==null||o.onSuccess({hash:m}),b({shouldCallAuthOnSuccess:!1});let u=await me.waitForTransactionReceipt({hash:m});if(u.status==="reverted")throw Error("Transaction failed");Ke(u)}catch(c){console.warn({transaction:(n==null?void 0:n.tx)??d,error:c}),re(c)}finally{se(!1)}}},validation:Ye,hasScanDetails:!!H,setIsScanDetailsOpen:oe,preventMaliciousTransaction:le,setPreventMaliciousTransaction:ue,tokensSent:Je,tokensReceived:et,isScanning:P==="in progress",isCancellable:(($e=(Ne=e.sendTransaction)==null?void 0:Ne.uiOptions)==null?void 0:$e.isCancellable)??!1,functionName:B})}};export{ea as SendTransactionScreen,ea as default};
