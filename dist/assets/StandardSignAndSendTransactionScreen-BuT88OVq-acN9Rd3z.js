import{f6 as kt,f7 as It,f8 as Ot,f9 as Tt,d5 as jt,d7 as Ct,d6 as _t,dA as Et,d9 as $,fa as $t,dX as Lt,d4 as g,fb as Ft,fc as bt,fd as Pt,ey as Bt,ds as At,fe as Rt,ff as Dt,fg as Mt,fh as Ut}from"./index-BZUZJG0z.js";import{t as Jt}from"./useGetSolPrice-Cfm8o9C5-DeeG65FR.js";import{ErrorScreenView as Nt}from"./ErrorScreen-DLsfgpC9-DwaPA2-1.js";import{F as qt}from"./CheckCircleIcon-D6_brTOf.js";import{T as zt,b as Wt,m as Ht}from"./ModalHeader-D5psNgrf-BlEKM6aB.js";import{s as Vt}from"./Layouts-BlFm53ED-D8gWrHLU.js";import{o as Xt}from"./ScreenHeader-CHmc4-Lu-D968ig42.js";import{t as Yt,s as z,e as W,n as H}from"./Value-tcJV9e0L-Dbu4EDrR.js";import{f as wt,y as Kt}from"./WalletLink-foFywOfy-BZGpYybr.js";import{i as Qt}from"./StackedContainer-B2vaEl56-CK5LNgwx.js";import{n as Zt,Y as Gt}from"./TransactionErrorView-CkMh0sTl-B3eKaaR4.js";import{t as Q}from"./transaction-CnfuREWo-nROljJQP.js";import{d as tn,c as xt,l as nn,u as en,f as an}from"./useSolanaRpcClient-C55AFEgY-BA5gsE4U.js";import{C as rn,e as on,n as sn,a as V,o as cn,d as dn,r as ln,t as un}from"./getFormattedUsdFromLamports-B6EqSEho-C-HCdwKa.js";import{i as P}from"./formatters-BCBPo00w.js";import"./reservoir-kvLjIrEo-Do6elMp6.js";import"./ScreenLayout-DIdy7nhJ-CtKEKsly.js";import"./Screen-q8npRQhQ-DadJ2eBF.js";import"./index-Dq_xe9dz-CmgW7sSb.js";import"./createLucideIcon-B72mi0g_.js";import"./lock-C--KDDhh.js";import"./LoadingSkeleton-U6-3yFwI-BqvAdjZO.js";import"./ethers-TpFbevgv-CT39HWSi.js";import"./ErrorMessage-D8VaAP5m-C-TFvMaa.js";import"./LabelXs-oqZNqbm_-D0IQxw2J.js";import"./Subtitle-CV-2yKE4-D-H5V56C.js";import"./Title-BnzYV3Is-BkAZi-Pa.js";import"./Address-BGlhcEcA-BeY89XEP.js";import"./check-BDT86Nu8.js";import"./copy-PrcWgVQF.js";import"./WalletInfoCard-BtliVaf0-C-OpDWgj.js";import"./shared-FM0rljBt-CEF3ZWm_.js";import"./Checkbox-BhNoOKjX-DF6rQPDu.js";import"./ErrorBanner-CQERa7bL-DhK9Px_L.js";import"./ExclamationCircleIcon-CTyaHNWt.js";import"./WarningBanner-c8L53pJ2-DNXOaIsr.js";import"./ExclamationTriangleIcon-CLH_TsZy.js";import"./ChevronDownIcon-k3TGnLFx.js";function pn(t){return!("exists"in t)||"exists"in t&&t.exists}function mn(t){const e=t.filter(n=>pn(n)&&n.data instanceof Uint8Array);if(e.length>0){const n=e.map(a=>a.address);throw new kt(It,{addresses:n})}}function fn(t,e){if(!e)return Object.freeze({address:t,exists:!1});const n=Tt().encode(e.data[0]);return Object.freeze({...St(e),address:t,data:n,exists:!0})}function gn(t,e){if(!e)return Object.freeze({address:t,exists:!1});const n=e.data.parsed.info||{};return(e.data.program||e.data.parsed.type)&&(n.parsedAccountMeta={program:e.data.program,type:e.data.parsed.type}),Object.freeze({...St(e),address:t,data:n,exists:!0})}function St(t){return Object.freeze({executable:t.executable,lamports:t.lamports,programAddress:t.owner,space:t.space})}async function hn(t,e,n={}){const{abortSignal:a,...l}=n;return(await t.getMultipleAccounts(e,{...l,encoding:"jsonParsed"}).send({abortSignal:a})).value.map((i,w)=>i&&typeof i=="object"&&"parsed"in i.data?gn(e[w],i):fn(e[w],i))}function yn(t){const e=t.filter(n=>!n.exists);if(e.length>0){const n=e.map(a=>a.address);throw new kt(Ot,{addresses:n})}}async function wn(t,e,n){if(t.length===0)return{};const a=await hn(e,t,n);return mn(a),yn(a),a.reduce((l,c)=>({...l,[c.address]:c.data.addresses}),{})}const kn=At.span`
  && {
    width: 82px;
    height: 82px;
    border-width: 4px;
    border-style: solid;
    border-color: ${t=>t.color??"var(--privy-color-accent)"};
    background-color: ${t=>t.color??"var(--privy-color-accent)"};
    border-radius: 50%;
    display: inline-block;
    box-sizing: border-box;
  }
`,bn=({instruction:t,fees:e,transactionInfo:n,solPrice:a,chain:l})=>g.jsxs(Yt,{children:[(n==null?void 0:n.action)&&g.jsxs(z,{children:[g.jsx(W,{children:"Action"}),g.jsx(H,{children:n.action})]}),(t==null?void 0:t.total)!=null&&g.jsxs(z,{children:[g.jsx(W,{children:"Total"}),g.jsx(H,{children:t.total})]}),!(t!=null&&t.total)&&(t==null?void 0:t.amount)!=null&&g.jsxs(z,{children:[g.jsx(W,{children:"Total"}),g.jsx(H,{children:g.jsx(wt,{quantities:[t.amount,e],tokenPrice:a})})]}),g.jsxs(z,{children:[g.jsx(W,{children:"Fees"}),g.jsx(H,{children:g.jsx(wt,{quantities:[e],tokenPrice:a})})]}),(t==null?void 0:t.to)&&g.jsxs(z,{children:[g.jsx(W,{children:"To"}),g.jsx(H,{children:g.jsx(Kt,{walletAddress:t.to,chainId:l,chainType:"solana"})})]})]}),An=({fees:t,onClose:e,receiptHeader:n,receiptDescription:a,transactionInfo:l,solPrice:c,signOnly:i,instruction:w,chain:T})=>g.jsxs(g.Fragment,{children:[g.jsx(zt,{onClose:e}),g.jsx(Qt,{style:{marginBottom:"16px"},children:g.jsxs("div",{children:[g.jsx(kn,{color:"var(--privy-color-success-light)"}),g.jsx(qt,{height:38,width:38,strokeWidth:2,stroke:"var(--privy-color-success)"})]})}),g.jsx(Xt,{title:n??`Transaction ${i?"signed":"complete"}!`,description:a??"You're all set."}),g.jsx(bn,{solPrice:c,instruction:w,fees:t,transactionInfo:l,chain:T}),g.jsx(Bt,{}),g.jsx(xn,{loading:!1,onClick:e,children:"Close"}),g.jsx(Vt,{}),g.jsx(Wt,{})]});let xn=At(Ht)`
  && {
    margin-top: 24px;
  }
  transition:
    color 350ms ease,
    background-color 350ms ease;
`;async function q(t,e){try{return await t}catch{return e}}function Sn(t){switch(t){case"solana:mainnet":return"mainnet-beta";case"solana:devnet":return"devnet";case"solana:testnet":return"testnet"}}async function L({privyClient:t,chain:e,mint:n}){let a=un[e];if(!a[n]){let l=await t.getSplTokenMetadata({mintAddress:n,cluster:Sn(e)});l&&(a[n]={address:n,symbol:l.symbol,decimals:l.decimals})}return a[n]}async function vn({tx:t,solanaClient:e,privyClient:n,checkFunds:a}){var U,h,J,R,D,C,M,B;let l=bt().decode(xt(t)),c=l.staticAccounts[0]??"",i=await nn({solanaClient:e,tx:t}),w=a?await q(en({solanaClient:e,tx:t})):void 0,T=(w==null?void 0:w.hasFunds)??!0,p={},d=[],I=await(async function({solanaClient:A,message:u}){if(!("addressTableLookups"in u)||!u.addressTableLookups)return[...u.staticAccounts];let s=u.addressTableLookups.map((m=>m.lookupTableAddress)),v=await wn(s,A.rpc),_=s.map(((m,x)=>{var F,O;return[...((F=u.addressTableLookups[x])==null?void 0:F.writableIndexes.map((E=>{var y;let k=(y=v[m])==null?void 0:y[E];if(k)return{key:k,isWritable:!0,altIdx:x}})))??[],...((O=u.addressTableLookups[x])==null?void 0:O.readonlyIndexes.map((E=>{var y;let k=(y=v[m])==null?void 0:y[E];if(k)return{key:k,isWritable:!1,altIdx:x}})))??[]]})).flat().filter((m=>!!m)).sort(((m,x)=>m.isWritable!==x.isWritable?m.isWritable?-1:1:m.altIdx-x.altIdx)).map((({key:m})=>m));return[...u.staticAccounts,..._]})({solanaClient:e,message:l});for(let A of l.instructions){let u=l.staticAccounts[A.programAddressIndex]||"";if(u!==on&&u!==sn)if(u!==V){if(u===cn){let s=await q((function(v,_,m){var k;let[x,F,O,E]=((k=v.accountIndices)==null?void 0:k.map((y=>_[y])))??[];return{type:"ata-creation",program:m,payer:x,ata:F,owner:O,mint:E}})(A,I,u));if(!s){d.push({type:"unknown",program:u,discriminator:(U=A.data)==null?void 0:U[0]});continue}if(d.push(s),s.ata&&s.owner&&s.mint){p[s.ata]={owner:s.owner,mint:s.mint};continue}}if(dn.includes(u)){let s=await q(Tn(A,I,e,n,u));if(!s){d.push({type:"unknown",program:u,discriminator:(h=A.data)==null?void 0:h[0]});continue}d.push(s)}else if(ln.includes(u)){let s=await q(jn(A,I,e,n,u));if(!s){d.push({type:"unknown",program:u,discriminator:(J=A.data)==null?void 0:J[0]});continue}d.push(s)}else d.push({type:"unknown",program:u,discriminator:(R=A.data)==null?void 0:R[0]})}else{let s=await q(On(A,I));if(!s){d.push({type:"unknown",program:u,discriminator:(D=A.data)==null?void 0:D[0]});continue}d.push(s)}else{let s=await q(In(A,I,e,n,p,u));if(!s){d.push({type:"unknown",program:u,discriminator:(C=A.data)==null?void 0:C[0]});continue}d.push(s),s.type==="spl-transfer"&&(s.fromAta&&s.fromAccount&&s.token.address&&(p[M=s.fromAta]??(p[M]={owner:s.fromAccount,mint:s.token.address})),s.toAta&&s.toAccount&&s.token.address&&(p[B=s.toAta]??(p[B]={owner:s.toAccount,mint:s.token.address})))}}return{spender:c,fee:i,instructions:d,hasFunds:!!T}}function j(t,e=0){try{return(function(a,l=0){let c=0n;for(let i=0;i<8;i++)c|=BigInt(a[l+i])<<BigInt(8*i);return c})(t,e)}catch{}try{return t.readBigInt64LE(e)}catch{}let n=an(t);try{return((a,l=0)=>{let c=a[l],i=a[l+7];if(!c||!i)throw Error(`Buffer offset out of range: first: ${c}, last: ${i}.`);return(BigInt(a[l+4]+256*a[l+5]+65536*a[l+6]+(i<<24))<<32n)+BigInt(c+256*a[++l]+65536*a[++l]+16777216*a[++l])})(n)}catch{}try{return n.subarray(e).readBigInt64LE()}catch{}try{return n.readBigInt64LE(e)}catch{}return 0n}async function In(t,e,n,a,l,c){var T,p,d,I,U,h,J,R,D,C,M,B,A;let i=(T=t.data)==null?void 0:T[0],w=((p=t.accountIndices)==null?void 0:p.map((u=>e[u])))??[];if(i===1){let[u,s,v]=w;return{type:"spl-init-account",program:c,account:u,mint:s,owner:v}}if(i===3){let u,s,[v,_,m]=w,x="",F=_?l[_]:void 0;if(F)u=F.owner,x=F.mint;else if(_){let k=await n.rpc.getAccountInfo(_,{commitment:"confirmed",encoding:"jsonParsed"}).send(),y=(d=k.value)==null?void 0:d.data;u=(U=(I=y==null?void 0:y.parsed)==null?void 0:I.info)==null?void 0:U.owner,x=((J=(h=y==null?void 0:y.parsed)==null?void 0:h.info)==null?void 0:J.mint)??"",s=(C=(D=(R=y==null?void 0:y.parsed)==null?void 0:R.info)==null?void 0:D.tokenAmount)==null?void 0:C.decimals}if(!x&&v){let k=await n.rpc.getAccountInfo(v,{commitment:"confirmed",encoding:"jsonParsed"}).send(),y=(M=k.value)==null?void 0:M.data;x=((A=(B=y==null?void 0:y.parsed)==null?void 0:B.info)==null?void 0:A.mint)??""}let O=await L({privyClient:a,chain:n.chain,mint:x}),E=(O==null?void 0:O.symbol)??"";return s??(s=(O==null?void 0:O.decimals)??9),{type:"spl-transfer",program:c,fromAta:v,fromAccount:m,toAta:_,toAccount:u,value:j(t.data,1),token:{symbol:E,decimals:s,address:x}}}if(i===9){let[u,s,v]=w;return{type:"spl-close-account",program:c,source:u,destination:s,owner:v}}if(i===17)return{type:"spl-sync-native",program:c};throw Error(`Token program instruction type ${i} not supported`)}async function On(t,e){var l,c;let n=(l=t.data)==null?void 0:l[0],a=((c=t.accountIndices)==null?void 0:c.map((i=>e[i])))??[];if(n===0){let[,i]=a;return{type:"create-account",program:V,account:i==null?void 0:i.toString(),value:j(t.data,4),withSeed:!1}}if(n===2){let[i,w]=a;return{type:"sol-transfer",program:V,fromAccount:i,toAccount:w,token:{symbol:"SOL",decimals:9},value:j(t.data,4),withSeed:!1}}if(n===3){let[,i]=a;return{type:"create-account",program:V,account:i,withSeed:!0,value:j(t.data.slice(t.data.length-32-8-8))}}if(n===11){let[i,w]=a;return{type:"sol-transfer",program:V,fromAccount:i,toAccount:w,value:j(t.data,4),token:{symbol:"SOL",decimals:9},withSeed:!0}}throw Error(`System program instruction type ${n} not supported`)}async function Tn(t,e,n,a,l){var w,T;let c=((w=t.accountIndices)==null?void 0:w.map((p=>e[p])))??[],i=(T=t.data)==null?void 0:T[0];if(i===143){let p=c[10],d=c[11];return{type:"raydium-swap-base-input",program:l,mintIn:p,mintOut:d,tokenIn:p?await L({privyClient:a,chain:n.chain,mint:p}):void 0,tokenOut:d?await L({privyClient:a,chain:n.chain,mint:d}):void 0,amountIn:j(t.data,8),minimumAmountOut:j(t.data,16)}}if(i===55){let p=c[10],d=c[11];return{type:"raydium-swap-base-output",program:l,mintIn:p,mintOut:d,tokenIn:p?await L({privyClient:a,chain:n.chain,mint:p}):void 0,tokenOut:d?await L({privyClient:a,chain:n.chain,mint:d}):void 0,maxAmountIn:j(t.data,8),amountOut:j(t.data,16)}}throw Error(`Raydium swap program instruction type ${i} not supported`)}async function jn(t,e,n,a,l){var w,T;let c=(w=t.data)==null?void 0:w[0],i=((T=t.accountIndices)==null?void 0:T.map((p=>e[p])))??[];if([208,51,239,151,123,43,237,92].includes(c)){let p=i[5],d=i[6];return{type:"jupiter-swap-exact-out-route",program:l,mintIn:p,mintOut:d,tokenIn:p?await L({privyClient:a,chain:n.chain,mint:p}):void 0,tokenOut:d?await L({privyClient:a,chain:n.chain,mint:d}):void 0,outAmount:j(t.data,t.data.length-1-2-8-8),quotedInAmount:j(t.data,t.data.length-1-2-8)}}if([176,209,105,168,154,125,69,62].includes(c)){let p=i[7],d=i[8];return{type:"jupiter-swap-exact-out-route",program:l,mintIn:p,mintOut:d,tokenIn:p?await L({privyClient:a,chain:n.chain,mint:p}):void 0,tokenOut:d?await L({privyClient:a,chain:n.chain,mint:d}):void 0,outAmount:j(t.data,t.data.length-1-2-8-8),quotedInAmount:j(t.data,t.data.length-1-2-8)}}if([193,32,155,51,65,214,156,129].includes(c)){let p=i[7],d=i[8];return{type:"jupiter-swap-shared-accounts-route",program:l,mintIn:p,mintOut:d,tokenIn:p?await L({privyClient:a,chain:n.chain,mint:p}):void 0,tokenOut:d?await L({privyClient:a,chain:n.chain,mint:d}):void 0,inAmount:j(t.data,t.data.length-1-2-8-8),quotedOutAmount:j(t.data,t.data.length-1-2-8)}}throw[62,198,214,193,213,159,108,210].includes(c)&&console.warn("Jupiter swap program instruction 'claim' not implemented"),[116,206,27,191,166,19,0,73].includes(c)&&console.warn("Jupiter swap program instruction 'claim_token' not implemented"),[26,74,236,151,104,64,183,249].includes(c)&&console.warn("Jupiter swap program instruction 'close_token' not implemented"),[229,194,212,172,8,10,134,147].includes(c)&&console.warn("Jupiter swap program instruction 'create_open_orders' not implemented"),[28,226,32,148,188,136,113,171].includes(c)&&console.warn("Jupiter swap program instruction 'create_program_open_orders' not implemented"),[232,242,197,253,240,143,129,52].includes(c)&&console.warn("Jupiter swap program instruction 'create_token_ledger' not implemented"),[147,241,123,100,244,132,174,118].includes(c)&&console.warn("Jupiter swap program instruction 'create_token_account' not implemented"),[229,23,203,151,122,227,173,42].includes(c)&&console.warn("Jupiter swap program instruction 'route' not implemented"),[150,86,71,116,167,93,14,104].includes(c)&&console.warn("Jupiter swap program instruction 'route_with_token_ledger' not implemented"),[228,85,185,112,78,79,77,2].includes(c)&&console.warn("Jupiter swap program instruction 'set_token_ledger' not implemented"),[230,121,143,80,119,159,106,170].includes(c)&&console.warn("Jupiter swap program instruction 'shared_accounts_route_with_token_ledger' not implemented"),Error(`Jupiter swap program instruction type ${c} not supported`)}const me={component:()=>{var G,tt,nt,et,at,rt,it,ot,st,ct,dt,lt,ut,pt,mt,ft,gt,ht,yt;let{data:t,onUserCloseViaDialogOrKeybindRef:e,setModalData:n,navigate:a}=jt(),{client:l,closePrivyModal:c,walletProxy:i,showFiatPrices:w}=Ct(),T=_t(),{user:p}=Et(),d=tn()(((G=t==null?void 0:t.standardSignAndSendTransaction)==null?void 0:G.chain)??"solana:mainnet"),[I,U]=$.useState((tt=t==null?void 0:t.standardSignAndSendTransaction)==null?void 0:tt.transaction),[h,J]=$.useState(),[R,D]=$.useState(),[C,M]=$.useState({value:0n,isLoading:!1}),[B,A]=$.useState(!1),[u,s]=$.useState({}),[v,_]=$.useState(),m=(nt=t==null?void 0:t.standardSignAndSendTransaction)==null?void 0:nt.account,x=!!((et=t==null?void 0:t.standardSignAndSendTransaction)!=null&&et.signOnly),F=m!=null&&m.imported?$t(p).find((o=>o.address===m.address)):Lt(p),{solPrice:O,isSolPriceLoading:E}=Jt({enabled:w}),k=$.useMemo((()=>{if(!h)return;let o=h.spender,f=Q(h.fee),b=Q(C.value,3,!0),S=h.instructions.filter((N=>["sol-transfer","spl-transfer","raydium-swap-base-input","raydium-swap-base-output","jupiter-swap-shared-accounts-route","jupiter-swap-exact-out-route"].includes(N.type))),r=S.at(0);return!r||S.length>1?{fee:f,spender:o,balance:b}:r.type==="sol-transfer"?{fee:f,spender:o,balance:b,total:Q(r.value)}:r.type==="spl-transfer"?{fee:f,spender:o,balance:b,total:`${P({amount:r.value,decimals:r.token.decimals})} ${r.token.symbol}`}:r.type==="raydium-swap-base-input"&&r.tokenIn&&r.tokenOut?{fee:f,spender:o,balance:b,swap:`${`${P({amount:r.amountIn,decimals:r.tokenIn.decimals})} ${r.tokenIn.symbol}`} → ${`${P({amount:r.minimumAmountOut,decimals:r.tokenOut.decimals})} ${r.tokenOut.symbol}`}`}:r.type==="raydium-swap-base-output"&&r.tokenIn&&r.tokenOut?{fee:f,spender:o,balance:b,swap:`${`${P({amount:r.maxAmountIn,decimals:r.tokenIn.decimals})} ${r.tokenIn.symbol}`} → ${`${P({amount:r.amountOut,decimals:r.tokenOut.decimals})} ${r.tokenOut.symbol}`}`}:r.type==="jupiter-swap-shared-accounts-route"&&r.tokenIn&&r.tokenOut?{fee:f,spender:o,balance:b,swap:`${`${P({amount:r.inAmount,decimals:r.tokenIn.decimals})} ${r.tokenIn.symbol}`} → ${`${P({amount:r.quotedOutAmount,decimals:r.tokenOut.decimals})} ${r.tokenOut.symbol}`}`}:r.type==="jupiter-swap-exact-out-route"&&r.tokenIn&&r.tokenOut?{fee:f,spender:o,balance:b,swap:`${`${P({amount:r.quotedInAmount,decimals:r.tokenIn.decimals})} ${r.tokenIn.symbol}`} → ${`${P({amount:r.outAmount,decimals:r.tokenOut.decimals})} ${r.tokenOut.symbol}`}`}:{fee:f,spender:o,balance:b}}),[h,m==null?void 0:m.address,C]),y=$.useMemo((()=>{let o;if(!h||!w||!O||E)return;function f(...r){return rn(r.reduce(((N,Y)=>N+Y),0n),O??0)}(m==null?void 0:m.address)===h.spender&&(o=f(h.fee));let b=f(C.value),S=h.instructions.filter((r=>r.type==="sol-transfer"||r.type==="spl-transfer")).at(0);return!S||h.instructions.length>1?{fee:o,balance:b}:S.type==="sol-transfer"?{fee:o,balance:b,total:f(S.value,(m==null?void 0:m.address)===h.spender?h.fee:0n)}:S.type==="spl-transfer"?{fee:o,balance:b,total:`${P({amount:S.value,decimals:S.token.decimals})} ${S.token.symbol}`}:{fee:o,balance:b}}),[h,w,O,E,m==null?void 0:m.address,C]);if($.useEffect((()=>{(async function(){if(I&&l)try{D(void 0);let o=await vn({tx:I,solanaClient:d,privyClient:l,checkFunds:!x});J(o)}catch(o){console.error("Failed to prepare transaction",o),D(o)}})()}),[I,d,l,x]),$.useEffect((()=>{(async function(){if(!m)return;M({value:C.value,isLoading:!0});let{value:o}=await d.rpc.getBalance(m.address,{commitment:"confirmed"}).send();M({value:o??0n,isLoading:!1})})().catch(console.error)}),[h]),!I||!(t!=null&&t.standardSignAndSendTransaction)||!m){let o=Error("Invalid transaction request");return g.jsx(Nt,{error:o,allowlistConfig:T.allowlistConfig,onRetry:()=>{var f;(f=t==null?void 0:t.standardSignAndSendTransaction)==null||f.onFailure(o),c({shouldCallAuthOnSuccess:!1})}})}let X=()=>{var o,f;if(!B)return u.signature||u.signedTransaction?(o=t==null?void 0:t.standardSignAndSendTransaction)==null||o.onSuccess({signature:u.signature,signedTransaction:u.signedTransaction}):(f=t==null?void 0:t.standardSignAndSendTransaction)==null||f.onFailure(v??R??Error("User exited the modal before submitting the transaction")),c({shouldCallAuthOnSuccess:!1})};e.current=X;let vt=(ot=(it=(rt=(at=t.standardSignAndSendTransaction)==null?void 0:at.uiOptions)==null?void 0:rt.transactionInfo)==null?void 0:it.contractInfo)!=null&&ot.imgUrl?g.jsx("img",{src:t.standardSignAndSendTransaction.uiOptions.transactionInfo.contractInfo.imgUrl,alt:t.standardSignAndSendTransaction.uiOptions.transactionInfo.contractInfo.imgAltText}):null,K=!!(t.funding&&t.funding.supportedOptions.length>0),Z=!(h!=null&&h.hasFunds)&&K;if(u.signature||u.signedTransaction){let o=h==null?void 0:h.instructions.filter((b=>b.type==="sol-transfer"||b.type==="spl-transfer")),f=(o==null?void 0:o.length)===1?o==null?void 0:o.at(0):void 0;return g.jsx(An,{fees:u.fees??0n,onClose:X,transactionInfo:(st=t.standardSignAndSendTransaction)==null?void 0:st.uiOptions.transactionInfo,solPrice:O,receiptHeader:(ct=t.standardSignAndSendTransaction)==null?void 0:ct.uiOptions.successHeader,receiptDescription:(dt=t.standardSignAndSendTransaction)==null?void 0:dt.uiOptions.successDescription,chain:d.chain,signOnly:x,instruction:(f==null?void 0:f.type)==="sol-transfer"?{to:f.toAccount,amount:f.value}:{to:(f==null?void 0:f.toAccount)||(f==null?void 0:f.toAta),total:k==null?void 0:k.total}})}return v?g.jsx(Zt,{transactionError:v,chainId:d.chain,onClose:X,chainType:"solana",onRetry:async()=>{_(void 0);let{value:o}=await d.rpc.getLatestBlockhash().send();var f,b;U((f=I,b=o,Ft(bt().decode(xt(f)),(S=>Ut(S)),(S=>Mt(b,S)),(S=>Dt(S)),(S=>new Uint8Array(Rt().encode(S))))))}}):g.jsx(Gt,{img:vt,title:((pt=(ut=(lt=t.standardSignAndSendTransaction)==null?void 0:lt.uiOptions)==null?void 0:ut.transactionInfo)==null?void 0:pt.title)||"Confirm transaction",subtitle:((ft=(mt=t.standardSignAndSendTransaction)==null?void 0:mt.uiOptions)==null?void 0:ft.description)||`${T.name} wants your permission to approve the following transaction.`,cta:Z?"Add funds":((ht=(gt=t.standardSignAndSendTransaction)==null?void 0:gt.uiOptions)==null?void 0:ht.buttonText)||"Approve",instructions:(h==null?void 0:h.instructions)??[],network:d.chain=="solana:mainnet"?"Solana":d.chain.replace("solana:",""),blockExplorerUrl:d.blockExplorerUrl,total:w?y==null?void 0:y.total:k==null?void 0:k.total,fee:w?y==null?void 0:y.fee:k==null?void 0:k.fee,balance:w?y==null?void 0:y.balance:k==null?void 0:k.balance,swap:k==null?void 0:k.swap,transactingWalletAddress:m.address,disabled:!(h!=null&&h.hasFunds)&&!K,isSubmitting:B,isPreparing:!h||C.isLoading,isTokenPriceLoading:w&&E,isMissingFunds:!(h!=null&&h.hasFunds),submitError:v??void 0,isSponsored:!!((yt=t.standardSignAndSendTransaction)!=null&&yt.isSponsored),parseError:R,onClick:Z?async()=>{if(!m)return;if(!K)throw Error("Funding wallet is not enabled");let o="FundingMethodSelectionScreen";n({...t,funding:{...t.funding,methodScreen:o},solanaFundingData:t==null?void 0:t.solanaFundingData}),a(o)}:async()=>{try{if(A(!0),B||!m||!i||!p||!F)return;let o=await t.standardSignAndSendTransaction.onConfirm(I);if("signature"in o){let f=await(async function({solanaClient:b,signature:S}){var Y;let r=Pt().decode(S),N=await b.rpc.getTransaction(r,{maxSupportedTransactionVersion:0,commitment:"confirmed",encoding:"base64"}).send().catch((()=>null));return N?{fee:((Y=N.meta)==null?void 0:Y.fee)??0n}:null})({solanaClient:d,signature:o.signature});return void s({...o,fees:f==null?void 0:f.fee})}s(o)}catch(o){console.warn({transaction:I,error:o}),_(o)}finally{A(!1)}},onClose:X})}};export{me as StandardSignAndSendTransactionScreen,me as default};
